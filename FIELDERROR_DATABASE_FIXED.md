# üóÑÔ∏è –ò–°–ü–†–ê–í–õ–ï–ù–ê –û–®–ò–ë–ö–ê FIELDERROR –í –ë–ê–ó–ï –î–ê–ù–ù–´–• ‚úÖ

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ—à–∏–±–∫–∏:

### ‚ùå **–û–®–ò–ë–ö–ê:**
```
FieldError at /books/book/velikaya-kniga/
Unsupported lookup 'name' for ForeignKey or join on the field not permitted.
```

### üïµÔ∏è **–ü–†–ò–ß–ò–ù–ê:**
–í –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –ø–æ–ª–µ `product__name__icontains`, –Ω–æ –≤ –º–æ–¥–µ–ª–∏ `Product` –ø–æ–ª–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `title`, –∞ –Ω–µ `name`.

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

### **–ú–æ–¥–µ–ª—å Product (shop/models.py):**
```python
class Product(models.Model):
    title = models.CharField('–ù–∞–∑–≤–∞–Ω–∏–µ', max_length=200)  ‚Üê –ü–†–ê–í–ò–õ–¨–ù–û–ï –ü–û–õ–ï
    # –ù–ï–¢ –ø–æ–ª—è 'name' !!!
```

### **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ views.py:**

#### **1. –§—É–Ω–∫—Ü–∏—è `book_detail()` (—Å—Ç—Ä–æ–∫–∞ ~100):**
```python
# –î–û (–û–®–ò–ë–ö–ê):
user_can_read = Purchase.objects.filter(
    user=request.user,
    product__name__icontains=book.title  ‚ùå
).exists()

# –ü–û–°–õ–ï (–ò–°–ü–†–ê–í–õ–ï–ù–û):
user_can_read = Purchase.objects.filter(
    user=request.user,
    product__title__icontains=book.title  ‚úÖ
).exists()
```

#### **2. –§—É–Ω–∫—Ü–∏—è `modern_reader()` (—Å—Ç—Ä–æ–∫–∞ ~390):**
```python
# –î–û (–û–®–ò–ë–ö–ê):
user_can_read = Purchase.objects.filter(
    user=request.user,
    product__name__icontains=book.title  ‚ùå
).exists()

# –ü–û–°–õ–ï (–ò–°–ü–†–ê–í–õ–ï–ù–û):
user_can_read = Purchase.objects.filter(
    user=request.user,
    product__title__icontains=book.title  ‚úÖ
).exists()
```

#### **3. –§—É–Ω–∫—Ü–∏—è `read_book()` (—Å—Ç—Ä–æ–∫–∞ ~444):**
```python
# –î–û (–û–®–ò–ë–ö–ê):
user_can_read = Purchase.objects.filter(
    user=request.user,
    product__name__icontains=book.title  ‚ùå
).exists()

# –ü–û–°–õ–ï (–ò–°–ü–†–ê–í–õ–ï–ù–û):
user_can_read = Purchase.objects.filter(
    user=request.user,
    product__title__icontains=book.title  ‚úÖ
).exists()
```

## üìã **–ó–ê–¢–†–û–ù–£–¢–´–ï –§–£–ù–ö–¶–ò–ò:**

### ‚úÖ **–¢–µ–ø–µ—Ä—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:**
1. **`book_detail()`** - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–Ω–∏–≥–∏
2. **`modern_reader()`** - –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π reader –¥–ª—è —á—Ç–µ–Ω–∏—è
3. **`read_book()`** - –æ–±—ã—á–Ω–æ–µ —á—Ç–µ–Ω–∏–µ –∫–Ω–∏–≥–∏ –æ–Ω–ª–∞–π–Ω

### üéØ **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
–í—Å–µ —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç, –º–æ–∂–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —á–∏—Ç–∞—Ç—å –ø–ª–∞—Ç–Ω—É—é –∫–Ω–∏–≥—É, –∏—â–∞ –µ–≥–æ –ø–æ–∫—É–ø–∫–∏ –≤ –º–∞–≥–∞–∑–∏–Ω–µ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∫–Ω–∏–≥–∏.

## üîç **–î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ö–û–î–ê:**

### **–ü–æ–∏—Å–∫ –≤ –º–æ–¥–µ–ª–∏ Purchase:**
```python
# –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–≤—è–∑–µ–π:
Purchase.product ‚Üê ForeignKey –∫ Product
Product.title ‚Üê CharField —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Ç–æ–≤–∞—Ä–∞

# –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å:
Purchase.objects.filter(
    user=user,
    product__title__icontains=book_title  ‚úÖ
)
```

### **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–≤—ã–∑—ã–≤–∞–ª –æ—à–∏–±–∫—É):**
```python
Purchase.objects.filter(
    user=user,
    product__name__icontains=book_title  ‚ùå name –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!
)
```

## üéâ **–†–ï–ó–£–õ–¨–¢–ê–¢:**

### ‚úÖ **–ß–¢–û –¢–ï–ü–ï–†–¨ –†–ê–ë–û–¢–ê–ï–¢:**
1. **–î–µ—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–Ω–∏–≥** –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞** –∫ –ø–ª–∞—Ç–Ω—ã–º –∫–Ω–∏–≥–∞–º —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. **–ß—Ç–µ–Ω–∏–µ –∫–Ω–∏–≥** (–æ–±—ã—á–Ω–æ–µ –∏ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–µ) –¥–æ—Å—Ç—É–ø–Ω–æ
4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–∞–≥–∞–∑–∏–Ω–æ–º** —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### üîó **–õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞:**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç —á–∏—Ç–∞—Ç—å –∫–Ω–∏–≥—É
‚Üì
–ö–Ω–∏–≥–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è? ‚Üí –î–ê ‚Üí –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω
‚Üì –ù–ï–¢
–ï—Å—Ç—å –ø–æ–∫—É–ø–∫–∞ —ç—Ç–æ–π –∫–Ω–∏–≥–∏? ‚Üí –î–ê ‚Üí –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω
‚Üì –ù–ï–¢
–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω ‚Üí –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø–æ–∫—É–ø–∫—É
```

## üõ°Ô∏è **–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨:**
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å - –ø—Ä–æ—Å—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –Ω–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

## üìà **–ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨:**
–ó–∞–ø—Ä–æ—Å —Å—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –∏ —Ç–µ–ø–µ—Ä—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ Django ORM.

---

**–§–∞–π–ª –∏–∑–º–µ–Ω–µ–Ω:** `books/views.py`  
**–î–∞—Ç–∞:** 31.07.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** FieldError —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞ (name ‚Üí title)
