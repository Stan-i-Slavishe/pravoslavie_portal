# üõ†Ô∏è –†–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è —Å –¥–æ—Å—Ç—É–ø–æ–º –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. **Middleware –¥–ª—è —Ä–µ–∂–∏–º–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è**
- –§–∞–π–ª: `core/middleware/maintenance.py`
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞**: –°—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã **–í–°–ï–ì–î–ê** –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø
- –û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
- –î–æ—Å—Ç—É–ø –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º –≤—Ö–æ–¥–∞ `/accounts/login/` –∏ `/admin/login/` –¥–ª—è –≤—Ö–æ–¥–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

### 2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–¥–µ–ª—å—é SiteSettings**
- –†–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- –ü—É—Ç—å: `/admin/core/sitesettings/1/change/`
- –ü–æ–ª—è:
  - `maintenance_mode` - –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞
  - `maintenance_message` - —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### 3. **Context Processor**
- –§–∞–π–ª: `core/context_processors.py`
- –ü–µ—Ä–µ–¥–∞—ë—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–µ–∂–∏–º–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –≤–æ –≤—Å–µ —à–∞–±–ª–æ–Ω—ã
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
  - `is_maintenance_mode` - –≤–∫–ª—é—á–µ–Ω –ª–∏ —Ä–µ–∂–∏–º
  - `is_admin_in_maintenance` - —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
  - `maintenance_message` - —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è

### 4. **–í–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤**
- –§–∞–π–ª: `templates/includes/maintenance_indicator.html`
- –ö—Ä–∞—Å–Ω–∞—è –ø–æ–ª–æ—Å–∞ —Å–≤–µ—Ä—Ö—É —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
- –ö–Ω–æ–ø–∫–∞ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –®–∞–≥ 1: –í–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
1. –í–æ–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å: `http://localhost:8000/admin/`
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∞–π—Ç–∞" ‚Üí "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∞–π—Ç–∞"
3. –ü–æ—Å—Ç–∞–≤—å—Ç–µ –≥–∞–ª–æ—á–∫—É –Ω–∞ "–†–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è"
4. –í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
5. –ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É
1. **–ö–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä**:
   - –û—Å—Ç–∞–Ω—å—Ç–µ—Å—å –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –∏–ª–∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≥–ª–∞–≤–Ω—É—é
   - –í—ã —É–≤–∏–¥–∏—Ç–µ –∫—Ä–∞—Å–Ω—É—é –ø–æ–ª–æ—Å—É —Å–≤–µ—Ä—Ö—É: "–†–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–µ–Ω"
   - –°–∞–π—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—Å

2. **–ö–∞–∫ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**:
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ –∏–ª–∏ –≤—ã–π–¥–∏—Ç–µ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞
   - –í—ã —É–≤–∏–¥–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
   - –î–æ—Å—Ç—É–ø –∫ —Å–∞–π—Ç—É –∑–∞–∫—Ä—ã—Ç

### –®–∞–≥ 3: –í—ã–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
1. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
2. –°–Ω–∏–º–∏—Ç–µ –≥–∞–ª–æ—á–∫—É —Å "–†–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è"
3. –ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
4. –°–∞–π—Ç —Å–Ω–æ–≤–∞ –¥–æ—Å—Ç—É–ø–µ–Ω –≤—Å–µ–º

## üéØ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–æ—Å—Ç—É–ø–∞:
1. **–°—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã** ‚Üí –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø
2. **–°—Ç—Ä–∞–Ω–∏—Ü—ã –≤—Ö–æ–¥–∞** ‚Üí –î–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º (—á—Ç–æ–±—ã –∞–¥–º–∏–Ω –º–æ–≥ –≤–æ–π—Ç–∏)
3. **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã** ‚Üí –î–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º
4. **IP –∏–∑ –±–µ–ª–æ–≥–æ —Å–ø–∏—Å–∫–∞** ‚Üí –î–æ—Å—Ç—É–ø (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ settings)
5. **–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ** ‚Üí –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–æ–¥–µ:
```python
if request.user.is_authenticated and (request.user.is_superuser or request.user.is_staff):
    # –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
    response = self.get_response(request)
    return response
```

## üìù –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ (–≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö):
- `SiteSettings.maintenance_mode` - True/False
- `SiteSettings.maintenance_message` - —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –≤ settings.py):
```python
# IP-–∞–¥—Ä–µ—Å–∞, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø –≤ —Ä–µ–∂–∏–º–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
MAINTENANCE_MODE_ALLOWED_IPS = [
    '192.168.1.1',
    '10.0.0.1',
]
```

## üîß –§–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã

1. ‚úÖ `core/middleware/maintenance.py` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞
2. ‚úÖ `core/context_processors.py` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
3. ‚úÖ `config/settings_base.py` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏–º—è middleware
4. ‚úÖ `templates/includes/maintenance_indicator.html` - –æ–±–Ω–æ–≤–ª–µ–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤–∏–¥–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –∏–ª–∏ middleware –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω

**–†–µ—à–µ–Ω–∏–µ**:
```bash
python manage.py makemigrations
python manage.py migrate
python manage.py runserver
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
**–ü—Ä–∏—á–∏–Ω–∞**: Context processor –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `settings.py`:
```python
TEMPLATES = [{
    'OPTIONS': {
        'context_processors': [
            # ...
            'core.context_processors.maintenance_context',
        ],
    },
}]
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –í—Å–µ –≤–∏–¥—è—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
**–ü—Ä–∏—á–∏–Ω–∞**: Middleware —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—è–¥–æ–∫ middleware –≤ `settings.py`:
```python
MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'core.middleware.maintenance.MaintenanceModeMiddleware',  # –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—Ç–æ—Ä—ã–º!
    # ...
]
```

## ‚ú® –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –î–æ–±–∞–≤–∏—Ç—å –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
–í –º–æ–¥–µ–ª—å `SiteSettings` –¥–æ–±–∞–≤—å—Ç–µ:
```python
maintenance_end_time = models.DateTimeField(
    null=True, 
    blank=True,
    verbose_name='–ü–ª–∞–Ω–∏—Ä—É–µ–º–æ–µ –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è'
)
```

### 2. Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
–û—Ç–ø—Ä–∞–≤–ª—è—Ç—å email –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ —Ä–µ–∂–∏–º–∞:
```python
from django.core.mail import send_mail

if site_settings.maintenance_mode:
    send_mail(
        '–†–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω',
        '–°–∞–π—Ç –ø–µ—Ä–µ–≤–µ–¥–µ–Ω –≤ —Ä–µ–∂–∏–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è',
        'admin@site.com',
        ['admin@site.com'],
    )
```

### 3. –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Ä–µ–∂–∏–º–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é —Å –ø–æ–º–æ—â—å—é Celery.

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è —Å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤!

**–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ**: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å–∞–π—Ç –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –ø–æ–∫–∞ –æ–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è.
