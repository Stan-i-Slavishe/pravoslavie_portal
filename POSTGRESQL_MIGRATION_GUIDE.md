# üêò –ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ PostgreSQL - –ü—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–π –ø–æ—Ä—Ç–∞–ª

## üéØ –¶–µ–ª—å
–ü–µ—Ä–µ–≤–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞ —Å SQLite –Ω–∞ PostgreSQL –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```cmd
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∞—Å—Ç–µ—Ä-—Å–∫—Ä–∏–ø—Ç
postgresql_master.bat
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ—à–∞–≥–æ–≤—ã–π
```cmd
# 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PostgreSQL
setup_postgresql.bat

# 2. –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
migrate_to_postgresql.bat  

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
python check_migration.py

# 4. –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞
create_postgresql_backup.bat
```

## üìã –ß—Ç–æ –¥–µ–ª–∞—é—Ç —Å–∫—Ä–∏–ø—Ç—ã

### üîß `setup_postgresql.bat`
- –ü–æ–º–æ–≥–∞–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PostgreSQL
- –°–æ–∑–¥–∞–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö `pravoslavie_local_db`  
- –°–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `pravoslavie_user`
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

### üîÑ `migrate_to_postgresql.bat`
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ SQLite
- –û–±–Ω–æ–≤–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Django –¥–ª—è PostgreSQL
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –∫ –Ω–æ–≤–æ–π –ë–î
- –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
- –°–æ–∑–¥–∞–µ—Ç —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–∞–π—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### ‚úÖ `check_migration.py`
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
- –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –≤–æ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –º–µ–¥–∏–∞-—Ñ–∞–π–ª–∞–º

### üíæ `create_postgresql_backup.bat`
- –°–æ–∑–¥–∞–µ—Ç SQL –¥–∞–º–ø –ë–î
- –°–æ–∑–¥–∞–µ—Ç —Å–∂–∞—Ç—ã–π –¥–∞–º–ø –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è  
- –ö–æ–ø–∏—Ä—É–µ—Ç –º–µ–¥–∏–∞-—Ñ–∞–π–ª—ã
- –°–æ–∑–¥–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª

### üéõÔ∏è `postgresql_master.bat`
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
- –£–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º –º–∏–≥—Ä–∞—Ü–∏–∏

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ `.env.local` –±—É–¥—É—Ç –æ–±–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
```env
# –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ PostgreSQL
USE_SQLITE=False

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
DB_NAME=pravoslavie_local_db
DB_USER=pravoslavie_user  
DB_PASSWORD=local_strong_password_2024
DB_HOST=localhost
DB_PORT=5432
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. üåê –°–∞–π—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç: http://127.0.0.1:8000/
2. üëë –ê–¥–º–∏–Ω–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞: http://127.0.0.1:8000/admin/
3. üé¨ –†–∞—Å—Å–∫–∞–∑—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
4. üìö –ö–Ω–∏–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã
5. üõí –ú–∞–≥–∞–∑–∏–Ω —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
6. üßö –¢–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫–∞–∑–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±—ç–∫–∞–ø–æ–≤

```
backups/
‚îú‚îÄ‚îÄ sqlite_full_YYYYMMDD_HHMM.json    # –ü–æ–ª–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç SQLite
‚îú‚îÄ‚îÄ sqlite_clean_YYYYMMDD_HHMM.json   # –ß–∏—Å—Ç—ã–π —ç–∫—Å–ø–æ—Ä—Ç SQLite  
‚îî‚îÄ‚îÄ postgresql_YYYY-MM-DD_HH-MM-SS/   # –ë—ç–∫–∞–ø PostgreSQL
    ‚îú‚îÄ‚îÄ database.sql                   # SQL –¥–∞–º–ø
    ‚îú‚îÄ‚îÄ database.dump                  # –°–∂–∞—Ç—ã–π –¥–∞–º–ø
    ‚îú‚îÄ‚îÄ media/                         # –ú–µ–¥–∏–∞-—Ñ–∞–π–ª—ã
    ‚îî‚îÄ‚îÄ backup_info.txt               # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±—ç–∫–∞–ø–µ
```

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### PostgreSQL –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è
```cmd
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω
net start postgresql-x64-15

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ .env.local
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–∞—Ä–æ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
```

### –û—à–∏–±–∫–∏ –∏–º–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
```cmd
# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–º–ø–æ—Ä—Ç —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
python manage.py loaddata backups\sqlite_clean_*.json --verbosity=2

# –ò–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–æ —á–∞—Å—Ç—è–º
python manage.py dumpdata stories -o stories_backup.json
python manage.py loaddata stories_backup.json
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π
```sql
-- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ë–î —É–∫–∞–∂–∏—Ç–µ –∫–æ–¥–∏—Ä–æ–≤–∫—É
CREATE DATABASE pravoslavie_local_db 
  WITH ENCODING 'UTF8' 
  LC_COLLATE='Russian_Russia.1251' 
  LC_CTYPE='Russian_Russia.1251';
```

## ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫

- [ ] PostgreSQL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –∑–∞–ø—É—â–µ–Ω
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `pravoslavie_local_db` —Å–æ–∑–¥–∞–Ω–∞
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `pravoslavie_user` —Å–æ–∑–¥–∞–Ω
- [ ] –î–∞–Ω–Ω—ã–µ –∏–∑ SQLite —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∏ `.env.local` –æ–±–Ω–æ–≤–ª–µ–Ω—ã  
- [ ] Django –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ PostgreSQL
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- [ ] –î–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –°—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω
- [ ] –°–∞–π—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ PostgreSQL
- [ ] –°–æ–∑–¥–∞–Ω –±—ç–∫–∞–ø PostgreSQL

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ –Ω–∞ PostgreSQL:
1. üê≥ **Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è** - —É–ø–∞–∫–æ–≤–∫–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
2. üåê **–î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä** - —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω
3. üîÑ **CI/CD –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–µ–ø–ª–æ—è

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```cmd
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
psql -U pravoslavie_user -d pravoslavie_local_db

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–∞–±–ª–∏—Ü
\dt

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–º–ø–∞
pg_dump -U pravoslavie_user -d pravoslavie_local_db -f backup.sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –¥–∞–º–ø–∞  
psql -U pravoslavie_user -d pravoslavie_local_db -f backup.sql

# –ó–∞–ø—É—Å–∫ Django –Ω–∞ PostgreSQL
python manage.py runserver

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è Django –∫ –ë–î
python manage.py dbshell
```

---

**üéâ –£—Å–ø–µ—à–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostgreSQL –æ–∑–Ω–∞—á–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é –æ—Å–Ω–æ–≤—É –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è –ø—Ä–æ–µ–∫—Ç–∞!**