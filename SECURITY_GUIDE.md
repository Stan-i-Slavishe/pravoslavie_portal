# üõ°Ô∏è –°–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞–ª–∞

## üéØ –û–±–∑–æ—Ä –∑–∞—â–∏—Ç—ã

–ù–∞—à –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–π –ø–æ—Ä—Ç–∞–ª —Ç–µ–ø–µ—Ä—å –∑–∞—â–∏—â–µ–Ω –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç:
- **DDoS –∞—Ç–∞–∫** –∏ —Ñ–ª—É–¥–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
- **SQL injection** –∏ XSS –∞—Ç–∞–∫
- **–ë—Ä—É—Ç—Ñ–æ—Ä—Å –∞—Ç–∞–∫** –Ω–∞ —Ñ–æ—Ä–º—ã –≤—Ö–æ–¥–∞
- **–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤** –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö
- **–°–ø–∞–º–∞ —á–µ—Ä–µ–∑ –º–æ–±–∏–ª—å–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å**

## üöÄ –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
setup_security.bat
```

## üîß –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. Middleware —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ settings.py:
```python
MIDDLEWARE = [
    'core.middleware.security.BlacklistMiddleware',  # –ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫
    'core.middleware.security.SecurityMiddleware',   # –û—Å–Ω–æ–≤–Ω–∞—è –∑–∞—â–∏—Ç–∞
    # ... –¥—Ä—É–≥–∏–µ middleware ...
    'core.middleware.security.MonitoringMiddleware', # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
]
```

### 2. –õ–∏–º–∏—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ):
```python
SECURITY_RATE_LIMITS = {
    'requests_per_minute': 60,      # –ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
    'requests_per_hour': 1000,      # –ó–∞–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å  
    'mobile_feedback_per_hour': 10, # –ú–æ–±–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
    'login_attempts_per_hour': 10,  # –ü–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞
}
```

## üõ°Ô∏è –¢–∏–ø—ã –∑–∞—â–∏—Ç—ã

### 1. **Rate Limiting**
- ‚úÖ **60 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É** –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ **1000 –∑–∞–ø—Ä–æ—Å–æ–≤/—á–∞—Å** –º–∞–∫—Å–∏–º—É–º
- ‚úÖ **10 –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞/—á–∞—Å** –Ω–∞ IP
- ‚úÖ **10 –º–æ–±–∏–ª—å–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤/—á–∞—Å** –Ω–∞ IP

### 2. **–î–µ—Ç–µ–∫—Ü–∏—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤**
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏:
- `../` - Path traversal –∞—Ç–∞–∫–∏
- `<script` - XSS –ø–æ–ø—ã—Ç–∫–∏  
- `union select` - SQL injection
- `wp-admin` - WordPress –∞—Ç–∞–∫–∏
- `.php`, `.asp` - –ü–æ–∏—Å–∫ —É—è–∑–≤–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤
- `.env`, `.git` - –ü–æ–ø—ã—Ç–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω—Ñ–∏–≥–∞–º

### 3. **API Protection**
–°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –¥–ª—è:
- `/api/mobile-feedback/` - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–ø–∞–º–∞
- `/accounts/login/` - –ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
- `/admin/login/` - –ó–∞—â–∏—Ç–∞ –∞–¥–º–∏–Ω–∫–∏

### 4. **Security Headers**
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:
- `X-Content-Type-Options: nosniff`
- `X-Frame-Options: DENY`
- `X-XSS-Protection: 1; mode=block`
- `Content-Security-Policy` (–±–∞–∑–æ–≤—ã–π)
- `Referrer-Policy: strict-origin-when-cross-origin`

## üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP:
```bash
python manage.py security --show-blocked
```

### –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP:
```bash
python manage.py security --unblock-ip 192.168.1.100
```

### –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –≤—Ä—É—á–Ω—É—é:
```bash
python manage.py security --block-ip 192.168.1.100 --reason "Spam"
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
```bash
python manage.py security --stats
```

### –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫:
```bash
python manage.py security --clear-all
```

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–≥–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
- **–§–∞–π–ª:** `logs/security.log`
- **–ö–æ–Ω—Å–æ–ª—å:** –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **–£—Ä–æ–≤–Ω–∏:** INFO, WARNING, ERROR

### –ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–æ–≤:
```
[2025-01-XX 10:30:15] WARNING core.middleware.security: –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –æ—Ç 192.168.1.100: /admin.php
[2025-01-XX 10:30:16] ERROR core.middleware.security: –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∑–∞–ø—Ä–æ—Å –æ—Ç 192.168.1.100: Suspicious patterns detected
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### 1. –í–∫–ª—é—á–∏—Ç–µ Redis –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è:
```bash
# –í .env —Ñ–∞–π–ª–µ
REDIS_URL=redis://localhost:6379/0
```

### 2. –°—Ç—Ä–æ–≥–∏–µ –ª–∏–º–∏—Ç—ã –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
–ü—Ä–∏ `DEBUG=False` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞—é—Ç—Å—è —Å—Ç—Ä–æ–≥–∏–µ –ª–∏–º–∏—Ç—ã:
- 30 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É (–≤–º–µ—Å—Ç–æ 60)
- 500 –∑–∞–ø—Ä–æ—Å–æ–≤/—á–∞—Å (–≤–º–µ—Å—Ç–æ 1000)
- 5 –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞/—á–∞—Å (–≤–º–µ—Å—Ç–æ 10)

### 3. HTTPS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
```python
SECURE_SSL_REDIRECT = True
SECURE_HSTS_SECONDS = 31536000
SESSION_COOKIE_SECURE = True
CSRF_COOKIE_SECURE = True
```

## üî• –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∞—Ç–∞–∫–µ

### 1. **–ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤:**
```json
{
  "error": "Too many requests",
  "message": "–í–∞—à IP –∞–¥—Ä–µ—Å –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∏–∑-–∑–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏",
  "blocked_until": 1640995200
}
```

### 2. **–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:**
- IP –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –Ω–∞ 1 —á–∞—Å
- –ó–∞–ø–∏—Å—å –≤ –ª–æ–≥ —Å –¥–µ—Ç–∞–ª—è–º–∏ –∞—Ç–∞–∫–∏
- –í–æ–∑–≤—Ä–∞—Ç HTTP 429 (Too Many Requests)

### 3. **–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è:**
- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä—É—á–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–∞–≤—Å–µ–≥–¥–∞

## üÜò –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –º–µ—Ä—ã

### –ü—Ä–∏ –º–∞—Å—Å–æ–≤–æ–π –∞—Ç–∞–∫–µ:
```bash
# –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å –¥–∏–∞–ø–∞–∑–æ–Ω IP
python manage.py security --block-ip 192.168.1.0/24 --reason "Mass attack"

# –í–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É
# –ò–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ª–∏–º–∏—Ç—ã –≤ settings.py
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∞—Ç–∞–∫–∏:
```bash
# –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
python manage.py security --clear-all

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
tail -f logs/security.log

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
python manage.py runserver
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ß—Ç–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è:
- ‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ IP
- ‚úÖ –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ –û—à–∏–±–∫–∏ 4xx/5xx
- ‚úÖ POST –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (>2 —Å–µ–∫)

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º:
```python
# –î–æ–±–∞–≤—å—Ç–µ –≤ settings.py –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Sentry/ELK
LOGGING['handlers']['sentry'] = {
    'level': 'ERROR',
    'class': 'sentry_sdk.integrations.logging.EventHandler',
}
```

## üéØ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –í–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å:
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ** - middleware —Ä–∞–±–æ—Ç–∞—é—Ç –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ
- **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–µ—à–∏—Ä—É—é—Ç—Å—è
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å** - –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Redis –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π

## üîê –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. **–ù–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ (Nginx/Apache):**
```nginx
# Nginx rate limiting
limit_req_zone $binary_remote_addr zone=api:10m rate=1r/s;
limit_req zone=api burst=5 nodelay;
```

### 2. **Cloudflare/CDN:**
- –í–∫–ª—é—á–∏—Ç–µ DDoS protection
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ WAF –ø—Ä–∞–≤–∏–ª–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–µ–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫—É –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### 3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–µ—Ä–∞:**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
pip install psutil
# –î–æ–±–∞–≤—å—Ç–µ –∞–ª–µ—Ä—Ç—ã –Ω–∞ –≤—ã—Å–æ–∫—É—é –Ω–∞–≥—Ä—É–∑–∫—É
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ù–µ –±–ª–æ–∫–∏—Ä—É–π—Ç–µ –ø–æ–∏—Å–∫–æ–≤—ã—Ö –±–æ—Ç–æ–≤** - –¥–æ–±–∞–≤—å—Ç–µ –∏—Ö –≤ whitelist
2. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ª–∏–º–∏—Ç—ã** –Ω–∞ development –æ–∫—Ä—É–∂–µ–Ω–∏–∏
3. **–†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏** –Ω–∞ –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è
4. **–ò–º–µ–π—Ç–µ –ø–ª–∞–Ω –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è** –Ω–∞ —Å–ª—É—á–∞–π —Å–±–æ—è

---

**üéâ –í–∞—à –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–π –ø–æ—Ä—Ç–∞–ª —Ç–µ–ø–µ—Ä—å –Ω–∞–¥–µ–∂–Ω–æ –∑–∞—â–∏—â–µ–Ω –æ—Ç –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞—Ç–∞–∫!**

**üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞:** –ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.