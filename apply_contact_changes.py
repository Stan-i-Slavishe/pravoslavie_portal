#!/usr/bin/env python
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
–¥–ª—è –ø–æ–ª–µ–π –∞–¥—Ä–µ—Å–∞ –∏ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã –≤ SiteSettings
"""

import os
import sys
import django

# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º Django
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from django.core.management import execute_from_command_line
from core.models import SiteSettings

def main():
    print("üîß –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π –∞–¥—Ä–µ—Å–∞ –∏ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã...")
    
    try:
        # –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏—é
        print("üì¶ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏...")
        execute_from_command_line(['manage.py', 'migrate'])
        
        # –ó–∞–ø–æ–ª–Ω—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        print("üìù –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π...")
        settings = SiteSettings.get_settings()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ –∑–∞–ø–æ–ª–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ
        if not hasattr(settings, 'work_hours') or not settings.work_hours:
            settings.work_hours = '–ü–Ω-–ü—Ç: 9:00 - 18:00'
            settings.work_hours_note = '–ü–æ –º–æ—Å–∫–æ–≤—Å–∫–æ–º—É –≤—Ä–µ–º–µ–Ω–∏'
            settings.address_city = '–≥. –ú–æ—Å–∫–≤–∞'
            settings.address_country = '–†–æ—Å—Å–∏—è'
            settings.save()
            print("‚úÖ –ù–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã")
        else:
            print("‚úÖ –ó–Ω–∞—á–µ–Ω–∏—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç")
        
        print("\nüéâ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã!")
        print("\nüìã –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:")
        print("   ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è –≤ –º–æ–¥–µ–ª—å SiteSettings:")
        print("      - work_hours (–≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã)")
        print("      - work_hours_note (–ø—Ä–∏–º–µ—á–∞–Ω–∏–µ –∫ –≤—Ä–µ–º–µ–Ω–∏)")
        print("      - address_city (–≥–æ—Ä–æ–¥)")
        print("      - address_country (—Å—Ç—Ä–∞–Ω–∞)")
        print("      - address_full (–ø–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å)")
        print("\n   ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∫–∞ —Å –Ω–æ–≤—ã–º–∏ —Å–µ–∫—Ü–∏—è–º–∏:")
        print("      - '–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã'")
        print("      - '–ê–¥—Ä–µ—Å –∏ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ'")
        print("\n   ‚úÖ –®–∞–±–ª–æ–Ω –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î")
        print("\nüöÄ –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ:")
        print("   1. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä: python manage.py runserver")
        print("   2. –ó–∞–π—Ç–∏ –≤ –∞–¥–º–∏–Ω–∫—É: http://127.0.0.1:8000/admin/")
        print("   3. –ü–µ—Ä–µ–π—Ç–∏ –≤ '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∞–π—Ç–∞'")
        print("   4. –ò–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∏ –∞–¥—Ä–µ—Å")
        print("   5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        return 1
    
    return 0

if __name__ == '__main__':
    sys.exit(main())
