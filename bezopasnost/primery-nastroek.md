# üìã –ü—Ä–∏–º–µ—Ä—ã –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## üè¢ **–î–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —Å–∞–π—Ç–∞ (—Å—Ç—Ä–æ–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)**

### –í `config/settings.py`:
```python
SECURITY_RATE_LIMITS = {
    'requests_per_minute': 20,      # –û—á–µ–Ω—å —Å—Ç—Ä–æ–≥–æ
    'requests_per_hour': 200,       # –û—á–µ–Ω—å —Å—Ç—Ä–æ–≥–æ  
    'login_attempts_per_hour': 3,   # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å—Ç—Ä–æ–≥–æ
    'admin_attempts_per_hour': 2,   # –°—É–ø–µ—Ä —Å—Ç—Ä–æ–≥–æ
    'api_requests_per_minute': 10,  # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ
}
```

---

## üé™ **–î–ª—è —Å–∞–π—Ç–∞ —Å–æ–±—ã—Ç–∏–π/–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π (–º—è–≥–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)**

### –í `config/settings.py`:
```python
SECURITY_RATE_LIMITS = {
    'requests_per_minute': 120,     # –ú–Ω–æ–≥–æ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π
    'requests_per_hour': 3000,      # –í—ã—Å–æ–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
    'login_attempts_per_hour': 20,  # –ú–Ω–æ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π
    'admin_attempts_per_hour': 10,  # –ù–µ—Å–∫–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–æ–≤
    'api_requests_per_minute': 60,  # –ê–∫—Ç–∏–≤–Ω–æ–µ API
}
```

---

## üõí **–î–ª—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ (—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)**

### –í `config/settings.py`:
```python
SECURITY_RATE_LIMITS = {
    'requests_per_minute': 40,      # –°—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å  
    'requests_per_hour': 800,       # –ü–æ–∫—É–ø–∫–∏ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã
    'login_attempts_per_hour': 5,   # –ö–ª–∏–µ–Ω—Ç—ã –≤—Ö–æ–¥—è—Ç
    'admin_attempts_per_hour': 3,   # –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è
    'api_requests_per_minute': 25,  # API –∑–∞–∫–∞–∑–æ–≤
}

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞
SECURITY_EXTRA_PATTERNS = [
    r'coupon.*hack',        # –ü–æ–ø—ã—Ç–∫–∏ –≤–∑–ª–æ–º–∞ –∫—É–ø–æ–Ω–æ–≤
    r'price.*manipulation', # –ú–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ —Å —Ü–µ–Ω–∞–º–∏
    r'cart.*injection',     # –ò–Ω—ä–µ–∫—Ü–∏–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É
]
```

---

## üéì **–î–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞**

### –í `config/settings.py`:
```python
SECURITY_RATE_LIMITS = {
    'requests_per_minute': 80,      # –°—Ç—É–¥–µ–Ω—Ç—ã –∞–∫—Ç–∏–≤–Ω—ã
    'requests_per_hour': 1500,      # –ú–Ω–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
    'login_attempts_per_hour': 15,  # –ó–∞–±—ã–≤–∞—é—Ç –ø–∞—Ä–æ–ª–∏
    'admin_attempts_per_hour': 5,   # –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏
    'api_requests_per_minute': 40,  # –û–Ω–ª–∞–π–Ω —Ç–µ—Å—Ç—ã
}
```

---

## üåê **–î–ª—è –Ω–æ–≤–æ—Å—Ç–Ω–æ–≥–æ —Å–∞–π—Ç–∞**

### –í `config/settings.py`:
```python
SECURITY_RATE_LIMITS = {
    'requests_per_minute': 100,     # –ú–Ω–æ–≥–æ —á–∏—Ç–∞—Ç–µ–ª–µ–π
    'requests_per_hour': 2500,      # –í—ã—Å–æ–∫–∏–π —Ç—Ä–∞—Ñ–∏–∫
    'login_attempts_per_hour': 10,  # –ö–æ–º–º–µ–Ω—Ç–∞—Ç–æ—Ä—ã
    'admin_attempts_per_hour': 8,   # –†–µ–¥–∞–∫—Ü–∏—è
    'api_requests_per_minute': 50,  # RSS, API –Ω–æ–≤–æ—Å—Ç–µ–π
}
```

---

## üéÆ **–î–ª—è –∏–≥—Ä–æ–≤–æ–≥–æ/—Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞**

### –í `config/settings.py`:
```python
SECURITY_RATE_LIMITS = {
    'requests_per_minute': 150,     # –ê–∫—Ç–∏–≤–Ω—ã–µ –≥–µ–π–º–µ—Ä—ã
    'requests_per_hour': 4000,      # –ú–Ω–æ–≥–æ –∏–≥—Ä–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
    'login_attempts_per_hour': 25,  # –ü—Ä–æ–±—É—é—Ç –ø–∞—Ä–æ–ª–∏
    'admin_attempts_per_hour': 6,   # –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã
    'api_requests_per_minute': 80,  # –ò–≥—Ä–æ–≤–æ–µ API
}
```

---

## üß™ **–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è/—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**

### –í `config/settings.py`:
```python
SECURITY_RATE_LIMITS = {
    'requests_per_minute': 200,     # –ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
    'requests_per_hour': 10000,     # –¢–µ—Å—Ç–∏—Ä—É–µ–º –º–Ω–æ–≥–æ
    'login_attempts_per_hour': 50,  # –¢–µ—Å—Ç–æ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã
    'admin_attempts_per_hour': 20,  # –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏
    'api_requests_per_minute': 100, # API —Ç–µ—Å—Ç—ã
}

# –ò–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∏—Ç—å –∑–∞—â–∏—Ç—É
MIDDLEWARE = [
    # –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å security middleware
    # 'core.middleware.advanced_security.BlacklistMiddleware',
    # 'core.middleware.advanced_security.AdvancedSecurityMiddleware', 
    # 'core.middleware.advanced_security.MonitoringMiddleware',
]
```

---

## üö® **–≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏ –∞—Ç–∞–∫–µ**

### –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞:
```python
SECURITY_RATE_LIMITS = {
    'requests_per_minute': 5,       # –ö—Ä–∞–π–Ω–µ —Å—Ç—Ä–æ–≥–æ
    'requests_per_hour': 50,        # –ú–∏–Ω–∏–º—É–º
    'login_attempts_per_hour': 1,   # –ü–æ—á—Ç–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
    'admin_attempts_per_hour': 1,   # –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã
    'api_requests_per_minute': 2,   # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –º–∏–Ω–∏–º—É–º
}

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–∏ –∞—Ç–∞–∫–µ
SECURITY_EMERGENCY_PATTERNS = [
    r'bot',                 # –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –±–æ—Ç–æ–≤
    r'crawler',             # –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∞—É–ª–µ—Ä–æ–≤  
    r'scan',               # –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Å–∫–∞–Ω–µ—Ä—ã
    r'hack',               # –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ö–∞–∫–µ—Ä–æ–≤
    r'exploit',            # –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —ç–∫—Å–ø–ª–æ–∏—Ç—ã
]
```

---

## üìä **–ü—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–π –ø–æ—Ä—Ç–∞–ª (—Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)**

### –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–ª—è –¥—É—Ö–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞:
```python
SECURITY_RATE_LIMITS = {
    'requests_per_minute': 60,          # –£–º–µ—Ä–µ–Ω–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
    'requests_per_hour': 1000,          # –ß–∏—Ç–∞—é—Ç –∫–Ω–∏–≥–∏/—Ä–∞—Å—Å–∫–∞–∑—ã
    'mobile_feedback_per_hour': 10,     # –ú–æ–±–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
    'login_attempts_per_hour': 10,      # –ü—Ä–∏—Ö–æ–∂–∞–Ω–µ –≤—Ö–æ–¥—è—Ç
    'admin_attempts_per_hour': 5,       # –ê–¥–º–∏–Ω—ã –ø–æ—Ä—Ç–∞–ª–∞
    'api_requests_per_minute': 30,      # –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ API
}

# –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è —Ä–µ–ª–∏–≥–∏–æ–∑–Ω–æ–≥–æ —Å–∞–π—Ç–∞
SECURITY_RELIGIOUS_PATTERNS = [
    r'antichrist',         # –ó–∞—â–∏—Ç–∞ –æ—Ç –∫–æ—â—É–Ω—Å—Ç–≤–∞
    r'blasphemy',          # –ó–∞—â–∏—Ç–∞ –æ—Ç –±–æ–≥–æ—Ö—É–ª—å—Å—Ç–≤–∞
    r'sectarian',          # –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–µ–∫—Ç–∞–Ω—Ç—Å—Ç–≤–∞
]
```

---

## üîß **–ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**

### 1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω—É–∂–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ `config/settings.py`

### 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä:
```bash
python manage.py runserver
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å:
```bash
python manage.py security_admin --stats
```

### 4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –ª–∏–º–∏—Ç—ã:
```bash
python test_security.py
```

---

## ‚ö° **–ë—ã—Å—Ç—Ä–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤**

### –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã –Ω–∞—Å—Ç—Ä–æ–µ–∫:

**settings_strict.py:**
```python
from .settings import *

SECURITY_RATE_LIMITS = {
    'requests_per_minute': 20,
    'requests_per_hour': 200,
    # —Å—Ç—Ä–æ–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
}
```

**settings_soft.py:**
```python
from .settings import *

SECURITY_RATE_LIMITS = {
    'requests_per_minute': 120,
    'requests_per_hour': 3000,
    # –º—è–≥–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
}
```

### –ó–∞–ø—É—Å–∫ —Å —Ä–∞–∑–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:
```bash
# –°—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º
python manage.py runserver --settings=config.settings_strict

# –ú—è–≥–∫–∏–π —Ä–µ–∂–∏–º  
python manage.py runserver --settings=config.settings_soft
```

---

## üìà **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫**

### –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ:

```bash
# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç –ø–µ—Ä–≤—ã–µ 2 —á–∞—Å–∞
python manage.py security_admin --stats

# –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ IP
python manage.py security_admin --show-blocked

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f logs/django.log
```

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—à–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫:
- **< 2%** –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –æ–±—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
- **0 –∂–∞–ª–æ–±** –æ—Ç –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **> 90%** –∞—Ç–∞–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
- **< 50ms** –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞

---

## üéØ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É –Ω–∞—Å—Ç—Ä–æ–µ–∫**

### ü§î **–ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã:**

1. **–ù–∞—á–Ω–∏—Ç–µ —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫**
2. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ 1-2 –¥–Ω—è**
3. **–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É**
4. **–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π—Ç–µ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º**

### üìä **–ï—Å–ª–∏ –º–Ω–æ–≥–æ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π:**
- –£–≤–µ–ª–∏—á—å—Ç–µ –ª–∏–º–∏—Ç—ã –Ω–∞ 50%
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∞—Ç–∞–∫
- –î–æ–±–∞–≤—å—Ç–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –Ω—É–∂–Ω—ã—Ö IP

### üö® **–ï—Å–ª–∏ –º–∞–ª–æ –∞—Ç–∞–∫ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è:**
- –£–º–µ–Ω—å—à–∏—Ç–µ –ª–∏–º–∏—Ç—ã –Ω–∞ 30%
- –î–æ–±–∞–≤—å—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –¥–µ—Ç–µ–∫—Ü–∏–∏

---

*–ü—Ä–∏–º–µ—Ä—ã –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–∞–π—Ç–æ–≤*  
*–ü—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–π –ø–æ—Ä—Ç–∞–ª "–î–æ–±—Ä—ã–µ –∏—Å—Ç–æ—Ä–∏–∏"*  
*–ê–≤–≥—É—Å—Ç 2025*
