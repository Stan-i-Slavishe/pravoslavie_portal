#!/usr/bin/env python
"""
–°–æ–∑–¥–∞–Ω–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
"""

import os
import sys
import django
from datetime import date

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Django
sys.path.append(os.path.dirname(os.path.abspath(__file__)))
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from pwa.models import DailyOrthodoxInfo

# –î–∞–Ω–Ω—ã–µ –æ –ø–æ—Å—Ç–Ω—ã—Ö –¥–Ω—è—Ö –∏ –æ—Å–æ–±—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö
DAILY_ORTHODOX_DATA = [
    # –†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∏–µ –ø—Ä–∞–∑–¥–Ω–∏–∫–∏
    {'month': 1, 'day': 6, 'fasting_type': 'dry_eating',
     'fasting_description': '–†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∏–π —Å–æ—á–µ–ª—å–Ω–∏–∫',
     'allowed_food': '–°—É—Ö–æ—è–¥–µ–Ω–∏–µ –¥–æ –ø–µ—Ä–≤–æ–π –∑–≤–µ–∑–¥—ã',
     'spiritual_note': '–°–æ—á–µ–ª—å–Ω–∏–∫. –î–æ –≤–µ—á–µ—Ä–Ω–∏ - —Å—Ç—Ä–æ–≥–∏–π –ø–æ—Å—Ç, –ø–æ—Å–ª–µ - –ø—Ä–∞–∑–¥–Ω–∏—á–Ω–∞—è —Ç—Ä–∞–ø–µ–∑–∞. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –í–µ–ª–∏–∫–æ–º—É –ø—Ä–∞–∑–¥–Ω–∏–∫—É –†–æ–∂–¥–µ—Å—Ç–≤–∞.'},
    
    {'month': 1, 'day': 7, 'fasting_type': 'no_fast',
     'fasting_description': '–†–æ–∂–¥–µ—Å—Ç–≤–æ –•—Ä–∏—Å—Ç–æ–≤–æ',
     'allowed_food': '–ü—Ä–∞–∑–¥–Ω–∏—á–Ω–∞—è —Ç—Ä–∞–ø–µ–∑–∞',
     'spiritual_note': 'üéÑ –†–æ–∂–¥–µ—Å—Ç–≤–æ –•—Ä–∏—Å—Ç–æ–≤–æ! –í–µ–ª–∏–∫–∏–π –ø—Ä–∞–∑–¥–Ω–∏–∫ —Ä–æ–∂–¥–µ–Ω–∏—è –°–ø–∞—Å–∏—Ç–µ–ª—è. –í—Ä–µ–º—è —Ä–∞–¥–æ—Å—Ç–∏ –∏ –ª—é–±–≤–∏.'},
    
    {'month': 1, 'day': 18, 'fasting_type': 'dry_eating',
     'fasting_description': '–ö—Ä–µ—â–µ–Ω—Å–∫–∏–π —Å–æ—á–µ–ª—å–Ω–∏–∫',
     'allowed_food': '–°—É—Ö–æ—è–¥–µ–Ω–∏–µ –¥–æ –æ—Å–≤—è—â–µ–Ω–∏—è –≤–æ–¥—ã',
     'spiritual_note': '–°–æ—á–µ–ª—å–Ω–∏–∫ –ø–µ—Ä–µ–¥ –ö—Ä–µ—â–µ–Ω–∏–µ–º. –í—Ä–µ–º—è –æ—Å–æ–±–æ–π –º–æ–ª–∏—Ç–≤—ã –∏ –æ—á–∏—â–µ–Ω–∏—è.'},
    
    {'month': 1, 'day': 19, 'fasting_type': 'no_fast',
     'fasting_description': '–ö—Ä–µ—â–µ–Ω–∏–µ –ì–æ—Å–ø–æ–¥–Ω–µ',
     'allowed_food': '–ü—Ä–∞–∑–¥–Ω–∏—á–Ω–∞—è —Ç—Ä–∞–ø–µ–∑–∞',
     'spiritual_note': 'üíß –ö—Ä–µ—â–µ–Ω–∏–µ –ì–æ—Å–ø–æ–¥–Ω–µ! –û—Å–≤—è—â–µ–Ω–∏–µ –≤–æ–¥—ã –∏ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∫—Ä–µ—â–µ–Ω–∏—è –•—Ä–∏—Å—Ç–∞.'},
    
    # –í–µ–ª–∏–∫–∏–µ –ø—Ä–∞–∑–¥–Ω–∏–∫–∏
    {'month': 4, 'day': 7, 'fasting_type': 'with_fish',
     'fasting_description': '–ë–ª–∞–≥–æ–≤–µ—â–µ–Ω–∏–µ –ü—Ä–µ—Å–≤—è—Ç–æ–π –ë–æ–≥–æ—Ä–æ–¥–∏—Ü—ã',
     'allowed_food': '–ü—Ä–∞–∑–¥–Ω–∏—á–Ω–∞—è —Ç—Ä–∞–ø–µ–∑–∞ (–¥–∞–∂–µ –≤ –í–µ–ª–∏–∫–∏–π –ø–æ—Å—Ç –º–æ–∂–Ω–æ —Ä—ã–±—É)',
     'spiritual_note': 'üïäÔ∏è –ë–ª–∞–≥–æ–≤–µ—â–µ–Ω–∏–µ! –ê—Ä—Ö–∞–Ω–≥–µ–ª –ì–∞–≤—Ä–∏–∏–ª –≤–æ–∑–≤–µ—Å—Ç–∏–ª –î–µ–≤–µ –ú–∞—Ä–∏–∏ –æ —Ä–æ–∂–¥–µ–Ω–∏–∏ –°–ø–∞—Å–∏—Ç–µ–ª—è.'},
    
    {'month': 8, 'day': 19, 'fasting_type': 'no_fast',
     'fasting_description': '–ü—Ä–µ–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ì–æ—Å–ø–æ–¥–Ω–µ',
     'allowed_food': '–ü—Ä–∞–∑–¥–Ω–∏—á–Ω–∞—è —Ç—Ä–∞–ø–µ–∑–∞, –æ—Å–≤—è—â–µ–Ω–∏–µ –ø–ª–æ–¥–æ–≤',
     'spiritual_note': '‚ú® –ü—Ä–µ–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ì–æ—Å–ø–æ–¥–Ω–µ! –û—Å–≤—è—â–µ–Ω–∏–µ –ø–ª–æ–¥–æ–≤ –Ω–æ–≤–æ–≥–æ —É—Ä–æ–∂–∞—è.'},
    
    {'month': 8, 'day': 28, 'fasting_type': 'no_fast',
     'fasting_description': '–£—Å–ø–µ–Ω–∏–µ –ü—Ä–µ—Å–≤—è—Ç–æ–π –ë–æ–≥–æ—Ä–æ–¥–∏—Ü—ã',
     'allowed_food': '–ü—Ä–∞–∑–¥–Ω–∏—á–Ω–∞—è —Ç—Ä–∞–ø–µ–∑–∞',
     'spiritual_note': 'üå∏ –£—Å–ø–µ–Ω–∏–µ –ü—Ä–µ—Å–≤—è—Ç–æ–π –ë–æ–≥–æ—Ä–æ–¥–∏—Ü—ã! –ë–ª–∞–∂–µ–Ω–Ω–∞—è –∫–æ–Ω—á–∏–Ω–∞ –ú–∞—Ç–µ—Ä–∏ –ë–æ–∂–∏–µ–π.'},
    
    # –°—Ç—Ä–æ–≥–∏–µ –ø–æ—Å—Ç–Ω—ã–µ –¥–Ω–∏
    {'month': 9, 'day': 27, 'fasting_type': 'strict_fast',
     'fasting_description': '–í–æ–∑–¥–≤–∏–∂–µ–Ω–∏–µ –ö—Ä–µ—Å—Ç–∞ –ì–æ—Å–ø–æ–¥–Ω—è',
     'allowed_food': '–°—Ç—Ä–æ–≥–∏–π –ø–æ—Å—Ç (–∫–∞–∫ –≤ –ø—è—Ç–Ω–∏—Ü—É –í–µ–ª–∏–∫–æ–≥–æ –ø–æ—Å—Ç–∞)',
     'spiritual_note': '‚úùÔ∏è –í–æ–∑–¥–≤–∏–∂–µ–Ω–∏–µ –ö—Ä–µ—Å—Ç–∞ –ì–æ—Å–ø–æ–¥–Ω—è. –î–µ–Ω—å –æ—Å–æ–±–æ–≥–æ –ø–æ–∫–ª–æ–Ω–µ–Ω–∏—è –ö—Ä–µ—Å—Ç—É.'},
    
    {'month': 8, 'day': 29, 'fasting_type': 'strict_fast',
     'fasting_description': '–£—Å–µ–∫–Ω–æ–≤–µ–Ω–∏–µ –≥–ª–∞–≤—ã –ò–æ–∞–Ω–Ω–∞ –ü—Ä–µ–¥—Ç–µ—á–∏',
     'allowed_food': '–°—Ç—Ä–æ–≥–∏–π –ø–æ—Å—Ç',
     'spiritual_note': '–î–µ–Ω—å –ø–∞–º—è—Ç–∏ —É—Å–µ–∫–Ω–æ–≤–µ–Ω–∏—è –≥–ª–∞–≤—ã –ò–æ–∞–Ω–Ω–∞ –ü—Ä–µ–¥—Ç–µ—á–∏. –°—Ç—Ä–æ–≥–∏–π –ø–æ—Å—Ç.'},
    
    # –î–Ω–∏ –≤–µ–ª–∏–∫–∏—Ö —Å–≤—è—Ç—ã—Ö
    {'month': 12, 'day': 19, 'fasting_type': 'with_fish',
     'fasting_description': '–î–µ–Ω—å —Å–≤—è—Ç–∏—Ç–µ–ª—è –ù–∏–∫–æ–ª–∞—è –≤ –†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∏–π –ø–æ—Å—Ç',
     'allowed_food': '–†–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–∞—è –ø–∏—â–∞, —Ä—ã–±–∞, –º–∞—Å–ª–æ',
     'spiritual_note': '–î–µ–Ω—å –ø–∞–º—è—Ç–∏ —Å–≤—è—Ç–∏—Ç–µ–ª—è –ù–∏–∫–æ–ª–∞—è –ß—É–¥–æ—Ç–≤–æ—Ä—Ü–∞. –í–µ–ª–∏–∫–∏–π –∑–∞—Å—Ç—É–ø–Ω–∏–∫ –∏ –ø–æ–º–æ—â–Ω–∏–∫.'},
    
    {'month': 10, 'day': 8, 'fasting_type': 'light_fast',
     'fasting_description': '–î–µ–Ω—å –ø—Ä–µ–ø–æ–¥–æ–±–Ω–æ–≥–æ –°–µ—Ä–≥–∏—è –†–∞–¥–æ–Ω–µ–∂—Å–∫–æ–≥–æ',
     'allowed_food': '–†–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–∞—è –ø–∏—â–∞ —Å –º–∞—Å–ª–æ–º',
     'spiritual_note': '–î–µ–Ω—å –ø–∞–º—è—Ç–∏ –ø—Ä–µ–ø–æ–¥–æ–±–Ω–æ–≥–æ –°–µ—Ä–≥–∏—è –†–∞–¥–æ–Ω–µ–∂—Å–∫–æ–≥–æ. –ò–≥—É–º–µ–Ω –∑–µ–º–ª–∏ –†—É—Å—Å–∫–æ–π.'},
    
    {'month': 7, 'day': 8, 'fasting_type': 'light_fast',
     'fasting_description': '–î–µ–Ω—å —Å–≤—è—Ç—ã—Ö –ü–µ—Ç—Ä–∞ –∏ –§–µ–≤—Ä–æ–Ω–∏–∏',
     'allowed_food': '–†–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–∞—è –ø–∏—â–∞',
     'spiritual_note': '–î–µ–Ω—å —Å–≤—è—Ç—ã—Ö –ü–µ—Ç—Ä–∞ –∏ –§–µ–≤—Ä–æ–Ω–∏–∏ –ú—É—Ä–æ–º—Å–∫–∏—Ö. –ü–æ–∫—Ä–æ–≤–∏—Ç–µ–ª–∏ —Å–µ–º—å–∏ –∏ –±—Ä–∞–∫–∞.'},
    
    # –û—Å–æ–±—ã–µ –ø–æ—Å—Ç—ã
    {'month': 12, 'day': 4, 'fasting_type': 'light_fast',
     'fasting_description': '–î–µ–Ω—å –≤–≤–µ–¥–µ–Ω–∏—è –≤–æ —Ö—Ä–∞–º –ü—Ä–µ—Å–≤—è—Ç–æ–π –ë–æ–≥–æ—Ä–æ–¥–∏—Ü—ã',
     'allowed_food': '–†–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–∞—è –ø–∏—â–∞ —Å –º–∞—Å–ª–æ–º',
     'spiritual_note': '–í–≤–µ–¥–µ–Ω–∏–µ –≤–æ —Ö—Ä–∞–º –ü—Ä–µ—Å–≤—è—Ç–æ–π –ë–æ–≥–æ—Ä–æ–¥–∏—Ü—ã. –î–µ—Ç—Å—Ç–≤–æ –ë–æ–≥–æ—Ä–æ–¥–∏—Ü—ã.'},
    
    # –ü—Ä–∏–º–µ—Ä—ã –æ–±—ã—á–Ω—ã—Ö –ø–æ—Å—Ç–Ω—ã—Ö –¥–Ω–µ–π
    {'month': 1, 'day': 15, 'fasting_type': 'light_fast',
     'fasting_description': '–ü–æ—Å—Ç–Ω—ã–π –¥–µ–Ω—å (—Å—Ä–µ–¥–∞)',
     'allowed_food': '–†–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–∞—è –ø–∏—â–∞, –º–æ–∂–Ω–æ –º–∞—Å–ª–æ',
     'spiritual_note': '–û–±—ã—á–Ω—ã–π –ø–æ—Å—Ç–Ω—ã–π –¥–µ–Ω—å. –í—Ä–µ–º—è –¥–ª—è –º–æ–ª–∏—Ç–≤—ã –∏ –≤–æ–∑–¥–µ—Ä–∂–∞–Ω–∏—è.'},
    
    {'month': 1, 'day': 17, 'fasting_type': 'light_fast',
     'fasting_description': '–ü–æ—Å—Ç–Ω—ã–π –¥–µ–Ω—å (–ø—è—Ç–Ω–∏—Ü–∞)',
     'allowed_food': '–†–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–∞—è –ø–∏—â–∞, –º–æ–∂–Ω–æ –º–∞—Å–ª–æ',
     'spiritual_note': '–ü–æ—Å—Ç–Ω—ã–π –¥–µ–Ω—å –≤ –ø–∞–º—è—Ç—å —Å—Ç—Ä–∞–¥–∞–Ω–∏–π –•—Ä–∏—Å—Ç–æ–≤—ã—Ö.'},
    
    # –ü—Ä–∏–º–µ—Ä—ã –æ–±—ã—á–Ω—ã—Ö –¥–Ω–µ–π
    {'month': 1, 'day': 20, 'fasting_type': 'no_fast',
     'fasting_description': '–û–±—ã—á–Ω—ã–π –¥–µ–Ω—å',
     'allowed_food': '–õ—é–±–∞—è –ø–∏—â–∞',
     'spiritual_note': '–û–±—ã—á–Ω—ã–π –¥–µ–Ω—å. –ë–ª–∞–≥–æ–¥–∞—Ä–∏—Ç–µ –ë–æ–≥–∞ –∑–∞ –≤—Å–µ –¥–∞—Ä—ã. –í—Ä–µ–º—è –¥–ª—è –¥–æ–±—Ä—ã—Ö –¥–µ–ª.'},
]

def create_daily_orthodox_info():
    """–°–æ–∑–¥–∞–Ω–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏"""
    
    created_count = 0
    updated_count = 0
    
    for info_data in DAILY_ORTHODOX_DATA:
        daily_info, created = DailyOrthodoxInfo.objects.get_or_create(
            month=info_data['month'],
            day=info_data['day'],
            defaults=info_data
        )
        
        if created:
            created_count += 1
            print(f"‚úÖ –°–æ–∑–¥–∞–Ω –¥–µ–Ω—å: {daily_info}")
        else:
            # –û–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∑–∞–ø–∏—Å—å
            for key, value in info_data.items():
                if key not in ['month', 'day']:
                    setattr(daily_info, key, value)
            daily_info.save()
            updated_count += 1
            print(f"üîÑ –û–±–Ω–æ–≤–ª–µ–Ω –¥–µ–Ω—å: {daily_info}")
    
    print(f"\nüìä –†–µ–∑—É–ª—å—Ç–∞—Ç:")
    print(f"–°–æ–∑–¥–∞–Ω–æ –Ω–æ–≤—ã—Ö –¥–Ω–µ–π: {created_count}")
    print(f"–û–±–Ω–æ–≤–ª–µ–Ω–æ –¥–Ω–µ–π: {updated_count}")
    print(f"–í—Å–µ–≥–æ –¥–Ω–µ–π –≤ –±–∞–∑–µ: {DailyOrthodoxInfo.objects.count()}")

def test_daily_info():
    """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏"""
    print("\nüß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏...")
    
    # –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–∞–∑–Ω—ã–µ –¥–∞—Ç—ã
    test_dates = [
        date(2024, 1, 7),   # –†–æ–∂–¥–µ—Å—Ç–≤–æ
        date(2024, 1, 19),  # –ö—Ä–µ—â–µ–Ω–∏–µ
        date(2024, 12, 25), # –°—Ä–µ–¥–∞ (–ø–æ—Å—Ç–Ω—ã–π –¥–µ–Ω—å)
        date(2024, 12, 27), # –ü—è—Ç–Ω–∏—Ü–∞ (–ø–æ—Å—Ç–Ω—ã–π –¥–µ–Ω—å)
        date.today(),       # –°–µ–≥–æ–¥–Ω—è
    ]
    
    for test_date in test_dates:
        print(f"\nüìÖ {test_date.strftime('%d.%m.%Y')} ({['–ü–Ω','–í—Ç','–°—Ä','–ß—Ç','–ü—Ç','–°–±','–í—Å'][test_date.weekday()]})")
        
        daily_info = DailyOrthodoxInfo.get_info_for_date(test_date)
        
        print(f"   üçΩÔ∏è –ü–æ—Å—Ç: {daily_info.get_fasting_type_display()}")
        print(f"   ü•ó –ü–∏—â–∞: {daily_info.allowed_food}")
        if daily_info.spiritual_note:
            print(f"   üïäÔ∏è –ù–∞—Å—Ç–∞–≤–ª–µ–Ω–∏–µ: {daily_info.spiritual_note[:80]}...")

if __name__ == '__main__':
    print("üçΩÔ∏è –°–æ–∑–¥–∞–Ω–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è...")
    create_daily_orthodox_info()
    test_daily_info()
    print("\n‚ú® –ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å:")
    print("python manage.py makemigrations pwa")
    print("python manage.py migrate")
    print("python manage.py runserver")
    print("\n–û—Ç–∫—Ä–æ–π—Ç–µ: http://127.0.0.1:8000/pwa/daily-calendar/")
