#!/bin/bash

# –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –±–µ–π–¥–∂–∏ –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤
echo "üîß –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –±–µ–π–¥–∂–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–∞—Å—Å–∫–∞–∑–æ–≤ –≤ –ø–ª–µ–π–ª–∏—Å—Ç–∞—Ö..."

# –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É
FILE_PATH="/e/pravoslavie_portal/templates/stories/playlists_list.html"

# –°–æ–∑–¥–∞–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
cp "$FILE_PATH" "${FILE_PATH}.backup_$(date +%Y%m%d_%H%M%S)"

# –ò—Å–ø–æ–ª—å–∑—É–µ–º sed –¥–ª—è –∑–∞–º–µ–Ω—ã
# –ù–∞—Ö–æ–¥–∏–º —Å—Ç—Ä–æ–∫–∏ —Å {{ playlist.calculated_stories_count }} –∏ –∑–∞–º–µ–Ω—è–µ–º –Ω–∞ –≤–µ—Ä—Å–∏—é —Å "—Ä–∞—Å—Å–∫–∞–∑–æ–≤"
sed -i 's/{{ playlist\.calculated_stories_count }}$/{{ playlist.calculated_stories_count }} —Ä–∞—Å—Å–∫–∞–∑–æ–≤/g' "$FILE_PATH"

# –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
sed -i 's/—Ä–∞—Å—Å–∫–∞–∑–æ–≤ —Ä–∞—Å—Å–∫–∞–∑–æ–≤ —Ä–∞—Å—Å–∫–∞–∑–æ–≤/—Ä–∞—Å—Å–∫–∞–∑–æ–≤/g' "$FILE_PATH"
sed -i 's/—Ä–∞—Å—Å–∫–∞–∑–æ–≤ —Ä–∞—Å—Å–∫–∞–∑–æ–≤/—Ä–∞—Å—Å–∫–∞–∑–æ–≤/g' "$FILE_PATH"

echo "‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã!"
echo "üìã –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏:"

# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å —Ä–∞—Å—Å–∫–∞–∑–æ–≤
grep -n "calculated_stories_count.*—Ä–∞—Å—Å–∫–∞–∑–æ–≤" "$FILE_PATH"

echo ""
echo "üéâ –ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –≤ –±–µ–π–¥–∂–∞—Ö –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è '1 —Ä–∞—Å—Å–∫–∞–∑–æ–≤', '2 —Ä–∞—Å—Å–∫–∞–∑–æ–≤' –∏ —Ç.–¥."
