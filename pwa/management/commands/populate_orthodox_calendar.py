"""
Django Management –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ—Å—Ç–∞—Ö.
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: python manage.py populate_orthodox_calendar
"""

from django.core.management.base import BaseCommand
from django.utils import timezone
from datetime import date, timedelta
from pwa.models import DailyOrthodoxInfo, OrthodoxEvent

class Command(BaseCommand):
    help = '–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ—Å—Ç–∞—Ö'

    def add_arguments(self, parser):
        parser.add_argument(
            '--clear',
            action='store_true',
            help='–û—á–∏—Å—Ç–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º',
        )
        parser.add_argument(
            '--uspenie-only',
            action='store_true',
            help='–ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –£—Å–ø–µ–Ω—Å–∫–∏–π –ø–æ—Å—Ç',
        )

    def handle(self, *args, **options):
        self.stdout.write(
            self.style.SUCCESS('üïäÔ∏è –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è...')
        )

        if options['clear']:
            self.clear_existing_data()

        if options['uspenie_only']:
            self.populate_uspenie_fast_info()
            self.create_uspenie_orthodox_events()
        else:
            self.populate_full_calendar()

        self.show_statistics()
        
        self.stdout.write(
            self.style.SUCCESS('‚úÖ –ü—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–æ–ª–Ω–µ–Ω!')
        )

    def clear_existing_data(self):
        """–û—á–∏—Å—Ç–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö"""
        self.stdout.write('üßπ –û—á–∏—â–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ...')
        
        daily_count = DailyOrthodoxInfo.objects.count()
        events_count = OrthodoxEvent.objects.count()
        
        DailyOrthodoxInfo.objects.all().delete()
        OrthodoxEvent.objects.all().delete()
        
        self.stdout.write(
            self.style.WARNING(f'   –£–¥–∞–ª–µ–Ω–æ: {daily_count} –∑–∞–ø–∏—Å–µ–π –æ –ø–æ—Å—Ç–∞—Ö, {events_count} —Å–æ–±—ã—Ç–∏–π')
        )

    def populate_uspenie_fast_info(self):
        """–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –£—Å–ø–µ–Ω—Å–∫–æ–º –ø–æ—Å—Ç–µ"""
        self.stdout.write('üçá –ó–∞–ø–æ–ª–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –£—Å–ø–µ–Ω—Å–∫–æ–º –ø–æ—Å—Ç–µ...')
        
        # –£—Å–ø–µ–Ω—Å–∫–∏–π –ø–æ—Å—Ç: 14-27 –∞–≤–≥—É—Å—Ç–∞ 2025
        start_date = date(2025, 8, 14)
        end_date = date(2025, 8, 27)
        
        current = start_date
        created_count = 0
        updated_count = 0
        
        while current <= end_date:
            weekday = current.weekday()  # 0=–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, 6=–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ
            
            daily_info, created = DailyOrthodoxInfo.objects.get_or_create(
                month=current.month,
                day=current.day
            )
            
            if created:
                created_count += 1
            else:
                updated_count += 1
            
            # –£—Å–ø–µ–Ω—Å–∫–∏–π –ø–æ—Å—Ç —Å—Ç—Ä–æ–≥–∏–π –∫–∞–∫ –í–µ–ª–∏–∫–∏–π –ø–æ—Å—Ç
            if current.day == 19 and current.month == 8:  # –ü—Ä–µ–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ì–æ—Å–ø–æ–¥–Ω–µ
                daily_info.fasting_type = 'with_fish'
                daily_info.fasting_description = '–£—Å–ø–µ–Ω—Å–∫–∏–π –ø–æ—Å—Ç: –ü—Ä–µ–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ì–æ—Å–ø–æ–¥–Ω–µ (–Ø–±–ª–æ—á–Ω—ã–π –°–ø–∞—Å)'
                daily_info.allowed_food = '''üçé <strong>–ü—Ä–µ–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ì–æ—Å–ø–æ–¥–Ω–µ - –º–æ–∂–Ω–æ —Ä—ã–±—É!</strong>

–í –ø—Ä–∞–∑–¥–Ω–∏–∫ –ü—Ä–µ–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è:

‚úÖ <strong>–ú–æ–∂–Ω–æ:</strong>
‚Ä¢ –†—ã–±–∞ –∏ –º–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç—ã üêü
‚Ä¢ –†–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–∞—è –ø–∏—â–∞ —Å –º–∞—Å–ª–æ–º
‚Ä¢ –û–≤–æ—â–∏, —Ñ—Ä—É–∫—Ç—ã (–æ—Å–æ–±–µ–Ω–Ω–æ —è–±–ª–æ–∫–∏!)
‚Ä¢ –ö–∞—à–∏ —Å –º–∞—Å–ª–æ–º
‚Ä¢ –ì—Ä–∏–±—ã –∂–∞—Ä–µ–Ω—ã–µ
‚Ä¢ –û—Ä–µ—Ö–∏, –º–µ–¥
‚Ä¢ –í–∏–Ω–æ (–Ω–µ–º–Ω–æ–≥–æ)

üçé <strong>–¢—Ä–∞–¥–∏—Ü–∏—è:</strong> –û—Å–≤—è—â–µ–Ω–∏–µ —è–±–ª–æ–∫ –∏ –¥—Ä—É–≥–∏—Ö –ø–ª–æ–¥–æ–≤

‚ùå <strong>–ó–∞–ø—Ä–µ—â–µ–Ω–æ:</strong>
‚Ä¢ –ú—è—Å–æ –∏ –º—è—Å–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã
‚Ä¢ –ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã  
‚Ä¢ –Ø–π—Ü–∞'''
                daily_info.spiritual_note = 'üçé –ü—Ä–µ–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ì–æ—Å–ø–æ–¥–Ω–µ! –Ø–±–ª–æ—á–Ω—ã–π –°–ø–∞—Å. –ë–ª–∞–≥–æ—Å–ª–æ–≤–∏—Ç–µ –Ω–æ–≤—ã–π —É—Ä–æ–∂–∞–π –∏ –≤—Å–ø–æ–º–Ω–∏—Ç–µ –æ –ø—Ä–µ–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –¥—É—à–∏.'
                
            elif weekday in [0, 2, 4]:  # –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, —Å—Ä–µ–¥–∞, –ø—è—Ç–Ω–∏—Ü–∞ - —Å—É—Ö–æ—è–¥–µ–Ω–∏–µ
                daily_info.fasting_type = 'dry_eating'
                daily_info.fasting_description = '–£—Å–ø–µ–Ω—Å–∫–∏–π –ø–æ—Å—Ç: —Å—É—Ö–æ—è–¥–µ–Ω–∏–µ'
                daily_info.allowed_food = '''ü•ó <strong>–£—Å–ø–µ–Ω—Å–∫–∏–π –ø–æ—Å—Ç - —Å—É—Ö–æ—è–¥–µ–Ω–∏–µ (—Ö–æ–ª–æ–¥–Ω–∞—è –ø–∏—â–∞):</strong>

–ê–≤–≥—É—Å—Ç –±–æ–≥–∞—Ç –¥–∞—Ä–∞–º–∏ –ø—Ä–∏—Ä–æ–¥—ã!

‚úÖ <strong>–†–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è:</strong>
‚Ä¢ –°–≤–µ–∂–∏–µ –æ–≤–æ—â–∏: –æ–≥—É—Ä—Ü—ã, –ø–æ–º–∏–¥–æ—Ä—ã, –∫–∞–ø—É—Å—Ç–∞, –º–æ—Ä–∫–æ–≤—å, –ø–µ—Ä–µ—Ü
‚Ä¢ –õ–µ—Ç–Ω–∏–µ —Ñ—Ä—É–∫—Ç—ã: —è–±–ª–æ–∫–∏, –≥—Ä—É—à–∏, —Å–ª–∏–≤—ã, –ø–µ—Ä—Å–∏–∫–∏
‚Ä¢ –Ø–≥–æ–¥—ã: –≤–∏–Ω–æ–≥—Ä–∞–¥, –∞—Ä–±—É–∑, –¥—ã–Ω—è, —Å–º–æ—Ä–æ–¥–∏–Ω–∞
‚Ä¢ –û—Ä–µ—Ö–∏ –≤—Å–µ—Ö –≤–∏–¥–æ–≤
‚Ä¢ –°–µ–º–µ—á–∫–∏ –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω—ã–µ, —Ç—ã–∫–≤–µ–Ω–Ω—ã–µ
‚Ä¢ –ú–µ–¥ —Å–≤–µ–∂–∏–π
‚Ä¢ –•–ª–µ–± –ø–æ—Å—Ç–Ω—ã–π (–±–µ–∑ –º–æ–ª–æ–∫–∞ –∏ —è–∏—Ü)
‚Ä¢ –°—É—Ö–æ—Ñ—Ä—É–∫—Ç—ã: –∏–∑—é–º, –∫—É—Ä–∞–≥–∞, –∏–Ω–∂–∏—Ä
‚Ä¢ –í–æ–¥–∞, –∫–≤–∞—Å –¥–æ–º–∞—à–Ω–∏–π, –º–æ—Ä—Å—ã (—Ö–æ–ª–æ–¥–Ω—ã–µ)

‚ùå <strong>–ó–∞–ø—Ä–µ—â–∞–µ—Ç—Å—è:</strong>
‚Ä¢ –õ—é–±–∞—è –≥–æ—Ä—è—á–∞—è –ø–∏—â–∞
‚Ä¢ –†–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–æ–µ –º–∞—Å–ª–æ
‚Ä¢ –ü—Ä–æ–¥—É–∫—Ç—ã –∂–∏–≤–æ—Ç–Ω–æ–≥–æ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è
‚Ä¢ –í–∞—Ä–µ–Ω—å–µ (–º–æ–∂–Ω–æ –º–µ–¥)

üí° <strong>–°–æ–≤–µ—Ç:</strong> –î–µ–ª–∞–π—Ç–µ —Å–∞–ª–∞—Ç—ã –∏–∑ —Å–≤–µ–∂–∏—Ö –æ–≤–æ—â–µ–π –±–µ–∑ –º–∞—Å–ª–∞, –Ω–æ —Å –ª–∏–º–æ–Ω–Ω—ã–º —Å–æ–∫–æ–º'''
                daily_info.spiritual_note = '–î–µ–Ω—å —Å—É—Ö–æ—è–¥–µ–Ω–∏—è –≤ –£—Å–ø–µ–Ω—Å–∫–∏–π –ø–æ—Å—Ç. –í—Ä–µ–º—è —Å—Ç—Ä–æ–≥–æ–≥–æ –≤–æ–∑–¥–µ—Ä–∂–∞–Ω–∏—è –≤ –ø–∞–º—è—Ç—å –æ –ø–æ—Å—Ç–µ –ë–æ–≥–æ—Ä–æ–¥–∏—Ü—ã –ø–µ—Ä–µ–¥ –£—Å–ø–µ–Ω–∏–µ–º.'
                
            elif weekday in [1, 3]:  # –í—Ç–æ—Ä–Ω–∏–∫, —á–µ—Ç–≤–µ—Ä–≥ - –≥–æ—Ä—è—á–µ–µ –±–µ–∑ –º–∞—Å–ª–∞
                daily_info.fasting_type = 'strict_fast'
                daily_info.fasting_description = '–£—Å–ø–µ–Ω—Å–∫–∏–π –ø–æ—Å—Ç: –≥–æ—Ä—è—á–∞—è –ø–∏—â–∞ –±–µ–∑ –º–∞—Å–ª–∞'
                daily_info.allowed_food = '''üç≤ <strong>–£—Å–ø–µ–Ω—Å–∫–∏–π –ø–æ—Å—Ç - –≥–æ—Ä—è—á–µ–µ –±–µ–∑ –º–∞—Å–ª–∞:</strong>

‚úÖ <strong>–†–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è:</strong>
‚Ä¢ –ö–∞—à–∏ –Ω–∞ –≤–æ–¥–µ: –≥—Ä–µ—á–Ω–µ–≤–∞—è, –æ–≤—Å—è–Ω–∞—è, —Ä–∏—Å–æ–≤–∞—è, –ø—à–µ–Ω–Ω–∞—è
‚Ä¢ –ü–æ—Å—Ç–Ω—ã–µ —Å—É–ø—ã: –æ–≤–æ—â–Ω—ã–µ, –≥—Ä–∏–±–Ω—ã–µ, —â–∏ –ø–æ—Å—Ç–Ω—ã–µ
‚Ä¢ –û—Ç–≤–∞—Ä–Ω—ã–µ –æ–≤–æ—â–∏: –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å, –º–æ—Ä–∫–æ–≤—å, —Å–≤–µ–∫–ª–∞, –∫–∞–ø—É—Å—Ç–∞
‚Ä¢ –ö–∞—Ä—Ç–æ—Ñ–µ–ª—å –ø–µ—á–µ–Ω—ã–π –≤ –º—É–Ω–¥–∏—Ä–µ
‚Ä¢ –¢—É—à–µ–Ω—ã–µ –æ–≤–æ—â–∏ –±–µ–∑ –º–∞—Å–ª–∞
‚Ä¢ –ì—Ä–∏–±—ã –æ—Ç–≤–∞—Ä–Ω—ã–µ, —Ç—É—à–µ–Ω—ã–µ (–±–µ–∑ –º–∞—Å–ª–∞)
‚Ä¢ –ë–æ–±–æ–≤—ã–µ: –≥–æ—Ä–æ—Ö, —Ñ–∞—Å–æ–ª—å, —á–µ—á–µ–≤–∏—Ü–∞
‚Ä¢ –ú–∞–∫–∞—Ä–æ–Ω—ã (–∏–∑ —Ç–≤–µ—Ä–¥—ã—Ö —Å–æ—Ä—Ç–æ–≤ –ø—à–µ–Ω–∏—Ü—ã)
‚Ä¢ –ö–æ–º–ø–æ—Ç—ã –∏–∑ —Å–≤–µ–∂–∏—Ö —Ñ—Ä—É–∫—Ç–æ–≤
‚Ä¢ –ß–∞–π, –∫–æ—Ñ–µ, —Ç—Ä–∞–≤—è–Ω—ã–µ –æ—Ç–≤–∞—Ä—ã

‚ùå <strong>–ó–∞–ø—Ä–µ—â–∞–µ—Ç—Å—è:</strong>
‚Ä¢ –†–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–æ–µ –º–∞—Å–ª–æ –¥–ª—è –≥–æ—Ç–æ–≤–∫–∏
‚Ä¢ –ñ–∞—Ä–µ–Ω–∞—è –ø–∏—â–∞
‚Ä¢ –ü—Ä–æ–¥—É–∫—Ç—ã –∂–∏–≤–æ—Ç–Ω–æ–≥–æ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è
‚Ä¢ –°–ª–∏–≤–æ—á–Ω–æ–µ –º–∞—Å–ª–æ

üí° <strong>–†–µ—Ü–µ–ø—Ç:</strong> –û–≤–æ—â–Ω–æ–µ —Ä–∞–≥—É –±–µ–∑ –º–∞—Å–ª–∞ - —Ç—É—à–∏—Ç–µ –æ–≤–æ—â–∏ –≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º —Å–æ–∫—É'''
                daily_info.spiritual_note = '–ì–æ—Ä—è—á–∞—è –ø–∏—â–∞ –±–µ–∑ –º–∞—Å–ª–∞. –í—Ä–µ–º—è —É–º–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –¥—É—Ö–æ–≤–Ω–æ–≥–æ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–∏—è.'
                
            else:  # –°—É–±–±–æ—Ç–∞, –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ - –≥–æ—Ä—è—á–µ–µ —Å –º–∞—Å–ª–æ–º
                daily_info.fasting_type = 'with_oil'
                daily_info.fasting_description = '–£—Å–ø–µ–Ω—Å–∫–∏–π –ø–æ—Å—Ç: –≥–æ—Ä—è—á–∞—è –ø–∏—â–∞ —Å —Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω—ã–º –º–∞—Å–ª–æ–º'
                daily_info.allowed_food = '''ü´í <strong>–£—Å–ø–µ–Ω—Å–∫–∏–π –ø–æ—Å—Ç - –≥–æ—Ä—è—á–µ–µ —Å –º–∞—Å–ª–æ–º:</strong>

‚úÖ <strong>–†–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è:</strong>
‚Ä¢ –í—Å–µ –∫–∞—à–∏ —Å —Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω—ã–º –º–∞—Å–ª–æ–º
‚Ä¢ –ñ–∞—Ä–µ–Ω—ã–µ –∏ —Ç—É—à–µ–Ω—ã–µ –æ–≤–æ—â–∏
‚Ä¢ –û–≤–æ—â–Ω—ã–µ —Ä–∞–≥—É —Å –º–∞—Å–ª–æ–º
‚Ä¢ –°–∞–ª–∞—Ç—ã –∏–∑ —Å–≤–µ–∂–∏—Ö –æ–≤–æ—â–µ–π —Å –º–∞—Å–ª–æ–º
‚Ä¢ –ñ–∞—Ä–µ–Ω—ã–µ –≥—Ä–∏–±—ã
‚Ä¢ –ö–∞—Ä—Ç–æ—Ñ–µ–ª—å –∂–∞—Ä–µ–Ω—ã–π, –¥—Ä–∞–Ω–∏–∫–∏ –ø–æ—Å—Ç–Ω—ã–µ
‚Ä¢ –ü–æ—Å—Ç–Ω–∞—è –≤—ã–ø–µ—á–∫–∞ (–ø–∏—Ä–æ–∂–∫–∏ —Å –∫–∞–ø—É—Å—Ç–æ–π, –∫–∞—Ä—Ç–æ—à–∫–æ–π)
‚Ä¢ –ü–æ—Å—Ç–Ω—ã–µ –±–ª–∏–Ω—ã –Ω–∞ –≤–æ–¥–µ
‚Ä¢ –°–æ–ª–µ–Ω—ã–µ –∏ –º–∞—Ä–∏–Ω–æ–≤–∞–Ω–Ω—ã–µ –æ–≤–æ—â–∏
‚Ä¢ –í–∞—Ä–µ–Ω—å–µ, –¥–∂–µ–º—ã
‚Ä¢ –í–∏–Ω–æ –∫—Ä–∞—Å–Ω–æ–µ (–Ω–µ–º–Ω–æ–≥–æ, –ø–æ —Ü–µ—Ä–∫–æ–≤–Ω–æ–º—É —É—Å—Ç–∞–≤—É)

üçá <strong>–ê–≤–≥—É—Å—Ç–æ–≤—Å–∫–∏–µ —Ä–∞–¥–æ—Å—Ç–∏:</strong>
‚Ä¢ –°–≤–µ–∂–∏–π –≤–∏–Ω–æ–≥—Ä–∞–¥
‚Ä¢ –ê—Ä–±—É–∑—ã –∏ –¥—ã–Ω–∏
‚Ä¢ –Ø–±–ª–æ–∫–∏ –Ω–æ–≤–æ–≥–æ —É—Ä–æ–∂–∞—è
‚Ä¢ –ì—Ä—É—à–∏ –ª–µ—Ç–Ω–∏–µ

‚ùå <strong>–ó–∞–ø—Ä–µ—â–∞–µ—Ç—Å—è:</strong>
‚Ä¢ –ú—è—Å–æ –∏ –º—è—Å–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã
‚Ä¢ –ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã (–º–æ–ª–æ–∫–æ, —Å—ã—Ä, —Ç–≤–æ—Ä–æ–≥, —Å–º–µ—Ç–∞–Ω–∞)
‚Ä¢ –Ø–π—Ü–∞
‚Ä¢ –†—ã–±–∞ (–∫—Ä–æ–º–µ 19 –∞–≤–≥—É—Å—Ç–∞)

üí° <strong>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:</strong> –í—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ –ø–æ—Å—Ç–∞ –±–æ–ª–µ–µ –º—è–≥–∫–∏–µ'''
                daily_info.spiritual_note = '–í—ã—Ö–æ–¥–Ω–æ–π –¥–µ–Ω—å –ø–æ—Å—Ç–∞. –í—Ä–µ–º—è –º–æ–ª–∏—Ç–≤—ã –≤ —Å–µ–º–µ–π–Ω–æ–º –∫—Ä—É–≥—É –∏ –¥—É—Ö–æ–≤–Ω–æ–≥–æ –æ–±—â–µ–Ω–∏—è.'
            
            daily_info.save()
            current += timedelta(days=1)
        
        self.stdout.write(
            self.style.SUCCESS(f'   –°–æ–∑–¥–∞–Ω–æ: {created_count}, –æ–±–Ω–æ–≤–ª–µ–Ω–æ: {updated_count} –∑–∞–ø–∏—Å–µ–π –æ–± –£—Å–ø–µ–Ω—Å–∫–æ–º –ø–æ—Å—Ç–µ')
        )

    def create_uspenie_orthodox_events(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –£—Å–ø–µ–Ω—Å–∫–æ–≥–æ –ø–æ—Å—Ç–∞"""
        self.stdout.write('üìÖ –°–æ–∑–¥–∞–µ–º —Å–æ–±—ã—Ç–∏—è –£—Å–ø–µ–Ω—Å–∫–æ–≥–æ –ø–æ—Å—Ç–∞...')
        
        events = [
            (8, 14, "–ú–µ–¥–æ–≤—ã–π –°–ø–∞—Å (–ü—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –ß–µ—Å—Ç–Ω—ã—Ö –î—Ä–µ–≤)", "–ü–µ—Ä–≤—ã–π –°–ø–∞—Å. –û—Å–≤—è—â–µ–Ω–∏–µ –º–µ–¥–∞ –∏ –º–∞–∫–∞.", 'major_feast'),
            (8, 19, "–ü—Ä–µ–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ì–æ—Å–ø–æ–¥–Ω–µ (–Ø–±–ª–æ—á–Ω—ã–π –°–ø–∞—Å)", "–í–µ–ª–∏–∫–∏–π –ø—Ä–∞–∑–¥–Ω–∏–∫ –ü—Ä–µ–æ–±—Ä–∞–∂–µ–Ω–∏—è. –û—Å–≤—è—â–µ–Ω–∏–µ —è–±–ª–æ–∫ –∏ –≤–∏–Ω–æ–≥—Ä–∞–¥–∞.", 'great_feast'),
            (8, 28, "–£—Å–ø–µ–Ω–∏–µ –ü—Ä–µ—Å–≤—è—Ç–æ–π –ë–æ–≥–æ—Ä–æ–¥–∏—Ü—ã", "–í–µ–ª–∏–∫–∏–π –ø—Ä–∞–∑–¥–Ω–∏–∫ –£—Å–ø–µ–Ω–∏—è –ë–æ–∂–∏–µ–π –ú–∞—Ç–µ—Ä–∏.", 'great_feast'),
            (8, 29, "–û—Ä–µ—Ö–æ–≤—ã–π –°–ø–∞—Å (–ù–µ—Ä—É–∫–æ—Ç–≤–æ—Ä–Ω—ã–π –û–±—Ä–∞–∑)", "–¢—Ä–µ—Ç–∏–π –°–ø–∞—Å. –û—Å–≤—è—â–µ–Ω–∏–µ –æ—Ä–µ—Ö–æ–≤ –∏ —Ö–ª–µ–±–∞ –Ω–æ–≤–æ–≥–æ —É—Ä–æ–∂–∞—è.", 'major_feast'),
        ]
        
        created_count = 0
        updated_count = 0
        
        for month, day, title, description, event_type in events:
            event, created = OrthodoxEvent.objects.get_or_create(
                month=month,
                day=day,
                title=title,
                defaults={
                    'description': description,
                    'event_type': event_type,
                    'is_movable': False
                }
            )
            if created:
                created_count += 1
            else:
                updated_count += 1
        
        self.stdout.write(
            self.style.SUCCESS(f'   –°–æ–∑–¥–∞–Ω–æ: {created_count}, –æ–±–Ω–æ–≤–ª–µ–Ω–æ: {updated_count} —Å–æ–±—ã—Ç–∏–π')
        )

    def populate_full_calendar(self):
        """–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è"""
        self.stdout.write('üìÖ –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª–Ω—ã–π –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å...')
        
        # –ó–∞–ø–æ–ª–Ω—è–µ–º –£—Å–ø–µ–Ω—Å–∫–∏–π –ø–æ—Å—Ç
        self.populate_uspenie_fast_info()
        self.create_uspenie_orthodox_events()
        
        # –ó–∞–ø–æ–ª–Ω—è–µ–º —Å—Ä–µ–¥—ã –∏ –ø—è—Ç–Ω–∏—Ü—ã
        self.populate_wednesdays_fridays()
        
        # –°–æ–∑–¥–∞–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∞–∑–¥–Ω–∏–∫–∏
        self.create_main_orthodox_events()
        
        # –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ –¥–Ω–∏
        self.update_feast_days()

    def populate_wednesdays_fridays(self):
        """–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ—Å—Ç–Ω—ã—Ö —Å—Ä–µ–¥ –∏ –ø—è—Ç–Ω–∏—Ü"""
        self.stdout.write('üìø –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ—Å—Ç–Ω—ã–µ —Å—Ä–µ–¥—ã –∏ –ø—è—Ç–Ω–∏—Ü—ã...')
        
        created_count = 0
        updated_count = 0
        
        for month in range(1, 13):
            days_in_month = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month-1]
            if month == 2 and 2025 % 4 == 0:  # –í–∏—Å–æ–∫–æ—Å–Ω—ã–π –≥–æ–¥
                days_in_month = 29
                
            for day in range(1, days_in_month + 1):
                target_date = date(2025, month, day)
                weekday = target_date.weekday()
                
                if weekday in [2, 4]:  # –°—Ä–µ–¥–∞ –∏ –ø—è—Ç–Ω–∏—Ü–∞
                    daily_info, created = DailyOrthodoxInfo.objects.get_or_create(
                        month=month,
                        day=day
                    )
                    
                    if created:
                        created_count += 1
                    else:
                        updated_count += 1
                    
                    # –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—â–µ –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω –ø–æ—Å—Ç
                    if daily_info.fasting_type == 'no_fast':
                        day_name = "—Å—Ä–µ–¥–∞" if weekday == 2 else "–ø—è—Ç–Ω–∏—Ü–∞"
                        
                        daily_info.fasting_type = 'light_fast'
                        daily_info.fasting_description = f'–ü–æ—Å—Ç–Ω–∞—è {day_name}'
                        daily_info.allowed_food = f'''ü•¨ <strong>–ü–æ—Å—Ç–Ω–∞—è {day_name}:</strong>

‚úÖ <strong>–†–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è:</strong>
‚Ä¢ –†–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–∞—è –ø–∏—â–∞ –≤—Å–µ—Ö –≤–∏–¥–æ–≤
‚Ä¢ –ö–∞—à–∏ –Ω–∞ –≤–æ–¥–µ –∏–ª–∏ —Å —Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω—ã–º –º–∞—Å–ª–æ–º
‚Ä¢ –û–≤–æ—â–∏ (—Å–≤–µ–∂–∏–µ, —Ç—É—à–µ–Ω—ã–µ, –≤–∞—Ä–µ–Ω—ã–µ, –∂–∞—Ä–µ–Ω—ã–µ)
‚Ä¢ –§—Ä—É–∫—Ç—ã –∏ —è–≥–æ–¥—ã
‚Ä¢ –û—Ä–µ—Ö–∏ –∏ —Å–µ–º–µ—á–∫–∏
‚Ä¢ –ì—Ä–∏–±—ã –≤ –ª—é–±–æ–º –≤–∏–¥–µ
‚Ä¢ –†–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–æ–µ –º–∞—Å–ª–æ
‚Ä¢ –•–ª–µ–± (–±–µ–∑ –º–æ–ª–æ–∫–∞ –∏ —è–∏—Ü)
‚Ä¢ –ú–µ–¥, –≤–∞—Ä–µ–Ω—å–µ
‚Ä¢ –ù–∞–ø–∏—Ç–∫–∏: —á–∞–π, –∫–æ—Ñ–µ, —Å–æ–∫–∏, –∫–æ–º–ø–æ—Ç—ã

‚ùå <strong>–ù–µ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è:</strong>
‚Ä¢ –ú—è—Å–æ –∏ –º—è—Å–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã
‚Ä¢ –ú–æ–ª–æ–∫–æ –∏ –º–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã
‚Ä¢ –Ø–π—Ü–∞
‚Ä¢ –†—ã–±–∞ –∏ –º–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç—ã'''
                        
                        if weekday == 2:
                            daily_info.spiritual_note = '–°—Ä–µ–¥–∞ - –¥–µ–Ω—å –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø—Ä–µ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –ò—É–¥—ã. –í—Ä–µ–º—è –¥–ª—è –ø–æ–∫–∞—è–Ω–∏—è –∏ –¥–µ–ª –º–∏–ª–æ—Å–µ—Ä–¥–∏—è.'
                        else:
                            daily_info.spiritual_note = '–ü—è—Ç–Ω–∏—Ü–∞ - –¥–µ–Ω—å –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫—Ä–µ—Å—Ç–Ω—ã—Ö —Å—Ç—Ä–∞–¥–∞–Ω–∏–π –°–ø–∞—Å–∏—Ç–µ–ª—è. –î–µ–Ω—å –æ—Å–æ–±–æ–π –º–æ–ª–∏—Ç–≤—ã –∏ –≤–æ–∑–¥–µ—Ä–∂–∞–Ω–∏—è.'
                        
                        daily_info.save()
        
        self.stdout.write(
            self.style.SUCCESS(f'   –°–æ–∑–¥–∞–Ω–æ: {created_count}, –æ–±–Ω–æ–≤–ª–µ–Ω–æ: {updated_count} –∑–∞–ø–∏—Å–µ–π –æ —Å—Ä–µ–¥–∞—Ö –∏ –ø—è—Ç–Ω–∏—Ü–∞—Ö')
        )

    def create_main_orthodox_events(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π"""
        self.stdout.write('‚õ™ –°–æ–∑–¥–∞–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è...')
        
        # –í–µ–ª–∏–∫–∏–µ –ø—Ä–∞–∑–¥–Ω–∏–∫–∏
        great_feasts = [
            (1, 7, "–†–æ–∂–¥–µ—Å—Ç–≤–æ –•—Ä–∏—Å—Ç–æ–≤–æ", "–í–µ–ª–∏–∫–∏–π –ø—Ä–∞–∑–¥–Ω–∏–∫ –†–æ–∂–¥–µ—Å—Ç–≤–∞ –ì–æ—Å–ø–æ–¥–∞ –Ω–∞—à–µ–≥–æ –ò–∏—Å—É—Å–∞ –•—Ä–∏—Å—Ç–∞"),
            (1, 19, "–ö—Ä–µ—â–µ–Ω–∏–µ –ì–æ—Å–ø–æ–¥–Ω–µ (–ë–æ–≥–æ—è–≤–ª–µ–Ω–∏–µ)", "–í–µ–ª–∏–∫–∏–π –ø—Ä–∞–∑–¥–Ω–∏–∫ –ö—Ä–µ—â–µ–Ω–∏—è –ò–∏—Å—É—Å–∞ –•—Ä–∏—Å—Ç–∞ –≤ –ò–æ—Ä–¥–∞–Ω–µ"),
            (4, 7, "–ë–ª–∞–≥–æ–≤–µ—â–µ–Ω–∏–µ –ü—Ä–µ—Å–≤—è—Ç–æ–π –ë–æ–≥–æ—Ä–æ–¥–∏—Ü—ã", "–í–µ–ª–∏–∫–∏–π –ø—Ä–∞–∑–¥–Ω–∏–∫ –ë–ª–∞–≥–æ–≤–µ—â–µ–Ω–∏—è"),
            (9, 21, "–†–æ–∂–¥–µ—Å—Ç–≤–æ –ü—Ä–µ—Å–≤—è—Ç–æ–π –ë–æ–≥–æ—Ä–æ–¥–∏—Ü—ã", "–í–µ–ª–∏–∫–∏–π –ø—Ä–∞–∑–¥–Ω–∏–∫ –†–æ–∂–¥–µ—Å—Ç–≤–∞ –ë–æ–≥–æ–º–∞—Ç–µ—Ä–∏"),
            (9, 27, "–í–æ–∑–¥–≤–∏–∂–µ–Ω–∏–µ –ß–µ—Å—Ç–Ω–æ–≥–æ –∏ –ñ–∏–≤–æ—Ç–≤–æ—Ä—è—â–µ–≥–æ –ö—Ä–µ—Å—Ç–∞", "–í–µ–ª–∏–∫–∏–π –ø—Ä–∞–∑–¥–Ω–∏–∫ –í–æ–∑–¥–≤–∏–∂–µ–Ω–∏—è –ö—Ä–µ—Å—Ç–∞"),
            (12, 4, "–í–≤–µ–¥–µ–Ω–∏–µ –≤–æ —Ö—Ä–∞–º –ü—Ä–µ—Å–≤—è—Ç–æ–π –ë–æ–≥–æ—Ä–æ–¥–∏—Ü—ã", "–í–µ–ª–∏–∫–∏–π –ø—Ä–∞–∑–¥–Ω–∏–∫ –í–≤–µ–¥–µ–Ω–∏—è –≤–æ —Ö—Ä–∞–º"),
        ]
        
        created_count = 0
        
        for month, day, title, description in great_feasts:
            event, created = OrthodoxEvent.objects.get_or_create(
                month=month,
                day=day,
                title=title,
                defaults={
                    'description': description,
                    'event_type': 'great_feast',
                    'is_movable': False
                }
            )
            if created:
                created_count += 1
        
        self.stdout.write(
            self.style.SUCCESS(f'   –°–æ–∑–¥–∞–Ω–æ {created_count} –≤–µ–ª–∏–∫–∏—Ö –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤')
        )

    def update_feast_days(self):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–Ω–µ–π –≤–µ–ª–∏–∫–∏—Ö –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤"""
        self.stdout.write('üéâ –û–±–Ω–æ–≤–ª—è–µ–º –¥–Ω–∏ –≤–µ–ª–∏–∫–∏—Ö –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤...')
        
        great_feasts = OrthodoxEvent.objects.filter(event_type='great_feast', is_movable=False)
        updated_count = 0
        
        for feast in great_feasts:
            daily_info, created = DailyOrthodoxInfo.objects.get_or_create(
                month=feast.month,
                day=feast.day
            )
            
            daily_info.fasting_type = 'no_fast'
            daily_info.fasting_description = f'–í–µ–ª–∏–∫–∏–π –ø—Ä–∞–∑–¥–Ω–∏–∫: {feast.title}'
            daily_info.allowed_food = f'''üéâ <strong>–í–µ–ª–∏–∫–∏–π –ø—Ä–∞–∑–¥–Ω–∏–∫ - –ø–æ—Å—Ç–∞ –Ω–µ—Ç!</strong>

–í —á–µ—Å—Ç—å –ø—Ä–∞–∑–¥–Ω–∏–∫–∞ {feast.title} —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è –ª—é–±–∞—è –ø–∏—â–∞.

üçΩÔ∏è <strong>–ú–æ–∂–Ω–æ —É–ø–æ—Ç—Ä–µ–±–ª—è—Ç—å:</strong>
‚Ä¢ –í—Å–µ –≤–∏–¥—ã –º—è—Å–Ω—ã—Ö –±–ª—é–¥
‚Ä¢ –ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã
‚Ä¢ –Ø–π—Ü–∞ –≤ –ª—é–±–æ–º –≤–∏–¥–µ
‚Ä¢ –†—ã–±—É –∏ –º–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç—ã
‚Ä¢ –õ—é–±—É—é –¥—Ä—É–≥—É—é –ø–∏—â—É
‚Ä¢ –ü—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ —Å–ª–∞–¥–æ—Å—Ç–∏

üéä <strong>–¢—Ä–∞–¥–∏—Ü–∏—è:</strong> –ü—Ä–∞–∑–¥–Ω–∏—á–Ω–∞—è —Ç—Ä–∞–ø–µ–∑–∞ –≤ –∫—Ä—É–≥—É —Å–µ–º—å–∏'''
            daily_info.spiritual_note = f'üéâ {feast.title}! {feast.description}'
            daily_info.save()
            updated_count += 1
        
        self.stdout.write(
            self.style.SUCCESS(f'   –û–±–Ω–æ–≤–ª–µ–Ω–æ {updated_count} –¥–Ω–µ–π –≤–µ–ª–∏–∫–∏—Ö –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤')
        )

    def show_statistics(self):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É"""
        self.stdout.write('\nüìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è:')
        
        total_daily = DailyOrthodoxInfo.objects.count()
        total_events = OrthodoxEvent.objects.count()
        great_feasts = OrthodoxEvent.objects.filter(event_type='great_feast').count()
        
        no_fast = DailyOrthodoxInfo.objects.filter(fasting_type='no_fast').count()
        light_fast = DailyOrthodoxInfo.objects.filter(fasting_type='light_fast').count()
        strict_fast = DailyOrthodoxInfo.objects.filter(fasting_type='strict_fast').count()
        dry_eating = DailyOrthodoxInfo.objects.filter(fasting_type='dry_eating').count()
        with_oil = DailyOrthodoxInfo.objects.filter(fasting_type='with_oil').count()
        with_fish = DailyOrthodoxInfo.objects.filter(fasting_type='with_fish').count()
        
        # –£—Å–ø–µ–Ω—Å–∫–∏–π –ø–æ—Å—Ç
        uspenie_days = DailyOrthodoxInfo.objects.filter(
            month=8, day__gte=14, day__lte=27
        ).exclude(fasting_type='no_fast').count()
        
        self.stdout.write(f'   ‚Ä¢ –í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π –æ –ø–æ—Å—Ç–∞—Ö: {total_daily}')
        self.stdout.write(f'   ‚Ä¢ –ü—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π: {total_events}')
        self.stdout.write(f'   ‚Ä¢ –í–µ–ª–∏–∫–∏—Ö –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤: {great_feasts}')
        self.stdout.write(f'   ‚Ä¢ –î–Ω–µ–π –±–µ–∑ –ø–æ—Å—Ç–∞: {no_fast}')
        self.stdout.write(f'   ‚Ä¢ –î–Ω–µ–π –ª–µ–≥–∫–æ–≥–æ –ø–æ—Å—Ç–∞: {light_fast}')
        self.stdout.write(f'   ‚Ä¢ –î–Ω–µ–π —Å—Ç—Ä–æ–≥–æ–≥–æ –ø–æ—Å—Ç–∞: {strict_fast}')
        self.stdout.write(f'   ‚Ä¢ –î–Ω–µ–π —Å—É—Ö–æ—è–¥–µ–Ω–∏—è: {dry_eating}')
        self.stdout.write(f'   ‚Ä¢ –î–Ω–µ–π —Å –º–∞—Å–ª–æ–º: {with_oil}')
        self.stdout.write(f'   ‚Ä¢ –î–Ω–µ–π —Å —Ä—ã–±–æ–π: {with_fish}')
        self.stdout.write(f'   ‚Ä¢ –î–Ω–µ–π –£—Å–ø–µ–Ω—Å–∫–æ–≥–æ –ø–æ—Å—Ç–∞: {uspenie_days}')
        
        self.stdout.write('\nüìñ –ò—Å—Ç–æ—á–Ω–∏–∫–∏:')
        self.stdout.write('   ‚Ä¢ –¢–∏–ø–∏–∫–æ–Ω (—Ü–µ—Ä–∫–æ–≤–Ω—ã–π —É—Å—Ç–∞–≤)')
        self.stdout.write('   ‚Ä¢ –ü—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–π –∂—É—Ä–Ω–∞–ª "–§–æ–º–∞"')
        self.stdout.write('   ‚Ä¢ –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ —Ü–µ—Ä–∫–æ–≤–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏')
        self.stdout.write('   ‚Ä¢ –ú–æ—Å–∫–æ–≤—Å–∫–∞—è –ü–∞—Ç—Ä–∏–∞—Ä—Ö–∏—è')
