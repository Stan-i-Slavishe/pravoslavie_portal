<!-- stories/ajax/reply_item.html -->
<div class="reply-item mb-3 ajax-reply" data-comment-id="{{ reply.id }}">
    <div class="d-flex align-items-start">
        <!-- Аватар ответившего -->
        <div class="reply-avatar me-2">
            <div class="avatar-circle-small bg-info text-white">
                {% if reply.user.first_name %}{{ reply.user.first_name|first|upper }}{{ reply.user.last_name|first|upper }}{% else %}{{ reply.user.username|first|upper }}{% endif %}
            </div>
        </div>
        
        <!-- Содержимое ответа -->
        <div class="reply-content flex-grow-1">
            <div class="reply-header d-flex justify-content-between align-items-center mb-1">
                <div class="reply-meta">
                    <strong class="reply-author">{{ reply.user.get_full_name|default:reply.user.username }}</strong>
                    <span class="reply-time text-muted ms-2">{{ reply.get_time_since_posted }}</span>
                    <span class="badge bg-success ms-2 new-reply-badge">Новый</span>
                </div>
                {% if user == reply.user or user.is_staff %}
                <button class="btn btn-sm btn-outline-danger ajax-delete-comment" 
                       data-comment-id="{{ reply.id }}"
                       title="Удалить">
                    <i class="fas fa-times"></i>
                </button>
                {% endif %}
            </div>
            <div class="reply-text">
                <p class="mb-1 small">{{ reply.text|linebreaks }}</p>
            </div>
            
            <!-- Лайки для ответов -->
            {% if user.is_authenticated %}
            <div class="reply-reactions mt-1">
                <button class="btn btn-sm btn-outline-success ajax-reaction-btn me-1"
                        data-comment-id="{{ reply.id }}" 
                        data-reaction="like">
                    <i class="fas fa-thumbs-up"></i> <span class="likes-count">{{ reply.likes_count }}</span>
                </button>
                <button class="btn btn-sm btn-outline-danger ajax-reaction-btn"
                        data-comment-id="{{ reply.id }}" 
                        data-reaction="dislike">
                    <i class="fas fa-thumbs-down"></i> <span class="dislikes-count">{{ reply.dislikes_count }}</span>
                </button>
            </div>
            {% endif %}
        </div>
    </div>
</div>
