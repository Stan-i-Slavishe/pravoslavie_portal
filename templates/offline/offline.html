{% extends 'base.html' %}
{% load static %}

{% block title %}–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É{% endblock %}

{% block extra_css %}
<style>
.offline-container {
    min-height: 80vh;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    background: linear-gradient(135deg, var(--orthodox-blue), var(--gold-accent));
    color: white;
    margin: -20px;
    padding: 40px 20px;
}

.offline-content {
    max-width: 600px;
    animation: fadeIn 0.8s ease-in;
}

.offline-icon {
    font-size: 4rem;
    margin-bottom: 1rem;
    animation: pulse 2s infinite;
}

.offline-title {
    font-size: 2.5rem;
    font-weight: bold;
    margin-bottom: 1rem;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
}

.offline-message {
    font-size: 1.2rem;
    margin-bottom: 2rem;
    line-height: 1.6;
    opacity: 0.9;
}

.offline-actions {
    margin-top: 2rem;
}

.retry-btn {
    background: rgba(255,255,255,0.2);
    border: 2px solid white;
    color: white;
    padding: 12px 30px;
    border-radius: 25px;
    font-weight: bold;
    transition: all 0.3s ease;
    text-decoration: none;
    display: inline-block;
    margin: 0 10px;
}

.retry-btn:hover {
    background: white;
    color: var(--orthodox-blue);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.offline-features {
    background: rgba(255,255,255,0.1);
    border-radius: 15px;
    padding: 20px;
    margin-top: 2rem;
    backdrop-filter: blur(10px);
}

.feature-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.feature-list li {
    padding: 8px 0;
    border-bottom: 1px solid rgba(255,255,255,0.2);
}

.feature-list li:last-child {
    border-bottom: none;
}

.feature-list i {
    margin-right: 10px;
    width: 20px;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

.connection-status {
    margin-top: 2rem;
    padding: 15px;
    border-radius: 10px;
    background: rgba(255,255,255,0.1);
}

.status-online {
    background: rgba(76, 175, 80, 0.3) !important;
    border: 1px solid #4CAF50;
}

.status-offline {
    background: rgba(244, 67, 54, 0.3) !important;
    border: 1px solid #f44336;
}

@media (max-width: 768px) {
    .offline-title {
        font-size: 2rem;
    }
    
    .offline-message {
        font-size: 1rem;
    }
    
    .offline-container {
        padding: 20px 15px;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="offline-container">
    <div class="offline-content">
        <div class="offline-icon">
            <i class="fas fa-wifi" id="connection-icon"></i>
        </div>
        
        <h1 class="offline-title">–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É</h1>
        
        <p class="offline-message">
            –ù–µ –≤–æ–ª–Ω—É–π—Ç–µ—Å—å! –ú–Ω–æ–≥–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞—à–µ–≥–æ –ø–æ—Ä—Ç–∞–ª–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –∏ –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.
            –í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —á—Ç–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤.
        </p>
        
        <div class="connection-status" id="connection-status">
            <i class="fas fa-circle text-danger"></i>
            <span id="status-text">–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç</span>
        </div>
        
        <div class="offline-actions">
            <a href="/" class="retry-btn" onclick="window.location.reload()">
                <i class="fas fa-sync-alt"></i> –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
            </a>
            <a href="/fairy-tales/" class="retry-btn">
                <i class="fas fa-book-open"></i> –û—Ñ–ª–∞–π–Ω —Å–∫–∞–∑–∫–∏
            </a>
        </div>
        
        <div class="offline-features">
            <h3><i class="fas fa-check-circle"></i> –î–æ—Å—Ç—É–ø–Ω–æ –æ—Ñ–ª–∞–π–Ω:</h3>
            <ul class="feature-list">
                <li><i class="fas fa-book"></i> –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ç–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫–∞–∑–∫–∏</li>
                <li><i class="fas fa-bookmark"></i> –í–∞—à–∏ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</li>
                <li><i class="fas fa-list"></i> –°–æ–∑–¥–∞–Ω–Ω—ã–µ –ø–ª–µ–π–ª–∏—Å—Ç—ã</li>
                <li><i class="fas fa-download"></i> –°–∫–∞—á–∞–Ω–Ω—ã–µ –∫–Ω–∏–≥–∏</li>
                <li><i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</li>
            </ul>
        </div>
        
        <div class="mt-4">
            <small class="text-light">
                <i class="fas fa-info-circle"></i>
                –í—Å–µ –≤–∞—à–∏ –¥–µ–π—Å—Ç–≤–∏—è –±—É–¥—É—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
            </small>
        </div>
    </div>
</div>

<script>
// üåê –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
function updateConnectionStatus() {
    const isOnline = navigator.onLine;
    const statusElement = document.getElementById('connection-status');
    const statusText = document.getElementById('status-text');
    const connectionIcon = document.getElementById('connection-icon');
    
    if (isOnline) {
        statusElement.className = 'connection-status status-online';
        statusText.textContent = '–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ';
        connectionIcon.className = 'fas fa-wifi';
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
            window.location.href = '/';
        }, 2000);
    } else {
        statusElement.className = 'connection-status status-offline';
        statusText.textContent = '–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç';
        connectionIcon.className = 'fas fa-wifi-slash';
    }
}

// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
updateConnectionStatus();

// –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
window.addEventListener('online', updateConnectionStatus);
window.addEventListener('offline', updateConnectionStatus);

// –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
setInterval(() => {
    fetch('/ping/', { method: 'HEAD', cache: 'no-cache' })
        .then(() => {
            if (!navigator.onLine) {
                navigator.onLine = true;
                updateConnectionStatus();
            }
        })
        .catch(() => {
            if (navigator.onLine) {
                navigator.onLine = false;
                updateConnectionStatus();
            }
        });
}, 5000);
</script>
{% endblock %}
