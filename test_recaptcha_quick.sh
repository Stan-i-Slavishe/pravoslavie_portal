#!/bin/bash

# üß™ –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ reCAPTCHA –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

echo "üõ°Ô∏è –¢–ï–°–¢ GOOGLE reCAPTCHA v3 - –§–û–†–ú–ê –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò"
echo "=================================================="

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
if [ ! -f "manage.py" ]; then
    echo "‚ùå –§–∞–π–ª manage.py –Ω–µ –Ω–∞–π–¥–µ–Ω!"
    echo "   –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞"
    exit 1
fi

echo "üìÇ –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: $(pwd)"
echo ""

# –ü—Ä–æ–≤–µ—Ä—è–µ–º Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π..."
echo "--------------------------------"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º django-recaptcha
if python -c "import django_recaptcha" 2>/dev/null; then
    echo "‚úÖ django-recaptcha —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
else
    echo "‚ùå django-recaptcha –ù–ï —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!"
    echo "   –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: pip install django-recaptcha==4.0.0"
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º django-allauth
if python -c "import allauth" 2>/dev/null; then
    echo "‚úÖ django-allauth —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
else
    echo "‚ùå django-allauth –ù–ï —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!"
    exit 1
fi

echo ""

# –ó–∞–ø—É—Å–∫–∞–µ–º Python —Ç–µ—Å—Ç
echo "üß™ –ó–∞–ø—É—Å–∫ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫..."
echo "--------------------------------------"
python test_recaptcha_setup.py

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
if [ $? -eq 0 ]; then
    echo ""
    echo "üöÄ –¢–ï–°–¢ –ó–ê–í–ï–†–®–ï–ù –£–°–ü–ï–®–ù–û!"
    echo "========================="
    echo ""
    echo "üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:"
    echo "   1. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:"
    echo "      python manage.py runserver"
    echo ""
    echo "   2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:"
    echo "      http://127.0.0.1:8000/accounts/signup/"
    echo ""
    echo "   3. –î–µ–ø–ª–æ–π –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω:"
    echo "      git add ."
    echo "      git commit -m '–î–æ–±–∞–≤–ª–µ–Ω–∞ reCAPTCHA –≤ —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏'"
    echo "      git push origin main"
    echo "      ./deploy.sh"
    echo ""
    echo "üîó –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ reCAPTCHA:"
    echo "   https://www.google.com/recaptcha/admin"
else
    echo ""
    echo "‚ö†Ô∏è –û–ë–ù–ê–†–£–ñ–ï–ù–´ –ü–†–û–ë–õ–ï–ú–´!"
    echo "======================="
    echo ""
    echo "üìã –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:"
    echo "   ‚Ä¢ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: pip install -r requirements.txt"
    echo "   ‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ config/settings*.py"
    echo "   ‚Ä¢ –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∫–ª—é—á–∏ reCAPTCHA –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã"
    echo ""
    exit 1
fi
