@echo off
echo ========================================
echo  –ü–†–û–í–ï–†–ö–ê –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ë–õ–û–ö–ò–†–û–í–ö–ò –ë–î
echo ========================================

echo.
echo 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ Django...
python manage.py check

if %ERRORLEVEL% NEQ 0 (
    echo ‚ùå –û—à–∏–±–∫–∏ –≤ –∫–æ–¥–µ Django!
    pause
    exit /b 1
)

echo ‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å Django –≤ –ø–æ—Ä—è–¥–∫–µ.

echo.
echo 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î...
python manage.py makemigrations --dry-run

echo.
echo 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î...
python -c "
import django
import os
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from books.models import BookReview
from django.contrib.auth.models import User

print('‚úÖ –ò–º–ø–æ—Ä—Ç –º–æ–¥–µ–ª–µ–π —É—Å–ø–µ—à–µ–Ω')
print(f'üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤ –≤ –ë–î: {BookReview.objects.count()}')
print(f'üë• –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {User.objects.count()}')
print('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î —Ä–∞–±–æ—Ç–∞–µ—Ç')
"

if %ERRORLEVEL% EQU 0 (
    echo.
    echo ========================================
    echo ‚úÖ –í–°–ï –ü–†–û–í–ï–†–ö–ò –ü–†–û–ô–î–ï–ù–´ –£–°–ü–ï–®–ù–û!
    echo ========================================
    echo.
    echo –ò–∑–º–µ–Ω–µ–Ω–∏—è:
    echo ‚úì –§—É–Ω–∫—Ü–∏—è add_review –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞
    echo ‚úì –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ë–î  
    echo ‚úì –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏
    echo ‚úì –£–ª—É—á—à–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SQLite
    echo ‚úì –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ PRAGMA –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    echo.
    echo üéâ –¢–µ–ø–µ—Ä—å –æ—Ç–∑—ã–≤—ã –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫!
    echo.
) else (
    echo.
    echo ‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –ë–î
)

pause
